1000 PRINT"Amazing"
1010 INPUT"What are your width & length";H,V
1020 IFH<>1 AND V<>1THEN1040
1030 PRINT"Meaningless dimensions, try again"
1040 PRINT"Printout in progress"
1050 :REM'
1060 DIMW(H,V),V(H,V)
1070 Q=0
1080 Z=0
1090 X=RND(H)
1100 FORI=1TOH
1110 IF I=X THEN PRINT":  "; :ELSE PRINT":--";
1120 NEXT
1130 PRINT":"
1140 W(X,1)=1
1150 C=2
1160 R=X
1170 S=1
1180 GOTO 1250
1190 IFR<>H THEN1230
1200 R=1
1210 IF S=V THEN S=1 :ELSE S=S+1
1220 GOTO 1240
1230 R=R+1
1240 IFW(R,S)=0 THEN1190
1250 IF R=1 THEN GOTO 1610
1260 IF W(R-1,S)<>0 THEN1610
1270 IF S=1 THEN1420
1280 IF W(R,S-1)<>0 THEN1420
1290 IFR=H THEN1330
1300 IF W(R+1,S)<>0 THEN 1330
1310 X=RND(3)
1320 ON X GOTO 1990,2060,2130
1330 IF S<>V THEN1370
1340 IFZ=1 THEN1400
1350 Q=1
1360 GOTO 1380
1370 IF W(R,S+1)<>0 THEN1400
1380 X=RND(3)
1390 ON X GOTO 1990,2060,2190
1400 X=RND(2)
1410 ON X GOTO 1990,2060
1420 IF R=H THEN1530
1430 IF W(R+1,S)<>0 THEN1530
1440 IFS<>V THEN1480
1450 IFZ=1 THEN1510
1460 Q=1
1470 GOTO 1490
1480 IF W(R,S+1)<>0 THEN1510
1490 X=RND(3)
1500 ON X GOTO 1990,2130,2190
1510 X=RND(2)
1520 ON X GOTO1990,2130
1530 IF S<>V THEN1570
1540 IFZ=1 THEN1990
1550 Q=1
1560 GOTO 1580
1570 IF W(R,S+1)<>0 THEN1990
1580 X=RND(2)
1590 ON X GOTO 1990,2190
1600 STOP
1610 IFS=1 THEN1820
1620 IF W(R,S-1)<>0 THEN1820
1630 IF R=H THEN1740
1640 IF W(R+1,S)<>0 THEN1740
1650 IF S<>V THEN1690
1660 IF Z=1 THEN1720
1670 Q=1
1680 GOTO 1700
1690 IFW(R,S+1)<>0 THEN1720
1700 X=RND(3)
1710 ON X GOTO2060,2130,2190
1720 X=RND(2)
1730 ON X GOTO 2060,2130
1740 IFS<>V THEN1780
1750 IF Z=1 THEN2060
1760 Q=1
1770 GOTO 1790
1780 IF W(R,S+1)<>0 THEN2060
1790 X=RND(2)
1800 ON X GOTO 2060,2190
1810 STOP
1820 IF R=H THEN1920
1830 IF W(R+1,S)<>0 THEN1920
1840 IF S<>V THEN1880
1850 IF Z=1 THEN2130
1860 Q=1
1870 GOTO 2070
1880 IF W(R,S+1)<>0 THEN2130
1890 X=RND(2)
1900 ON X GOTO 2130,2190
1910 STOP
1920 IFS<>V THEN1960
1930 IF Z=1 THEN1190
1940 Q=1
1950 GOTO 2190
1960 IF W(R,S+1)<>0 THEN 1190
1970 GOTO2190
1980 STOP
1990 W(R-1,S)=1
2000 C=C+1
2010 V(R-1,S)=2
2020 R=R-1
2030 IFC=H*V+1 THEN2370
2040 Q=0
2050 GOTO 1250
2060 W(R,S-1)=1
2070 C=C+1
2080 V(R,S-1)=1
2090 S=S-1
2100 IF C=H*V+1 THEN GOTO 2370
2110 Q=0
2120 GOTO 1250
2130 W(R+1,S)=1
2140 C=C+1
2150 V(R,S) = V(R,S) OR 2
2160 R=R+1
2170 IF C=H*V+1 THEN2370
2180 GOTO1610
2190 IF Q=1 THEN2260
2200 W(R,S+1)=1
2210 C=C+1
2220 V(R,S) = V(R,S) OR 1
2230 S=S+1
2240 IF C=H*V+1 THEN GOTO 2370
2250 GOTO1250
2260 Z=1
2270 Q=0
2280 IF V(R,S)=0 THEN2310
2290 V(R,S)=3
2300 GOTO 1190
2310 V(R,S)=1
2320 R=1
2330 S=1
2340 GOTO 1240
2350 STOP
2360 :REM'------------------------------------------------------
2370 FORJ=1TO V
2380 PRINT"|";
2390 FORI=1TOH
2400 IF (V(I,J) AND 2)=0 THEN PRINT"  |"; :ELSE PRINT"   ";
2410 NEXT
2420 PRINT" "
2430 FORI=1TOH
2440 IF (V(I,J) AND 1)=0 THEN PRINT":--"; :ELSE PRINT":  ";
2450 NEXT
2460 PRINT":"
2470 NEXT
2480 END

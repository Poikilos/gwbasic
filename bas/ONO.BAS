10 RANDOMIZE TIMER
15 SCREEN 12
20 DIM A(108): DIM B$(15): DIM C(8, 4): DIM Q$(8)
30 FOR Z = 1 TO 54
40 READ A(Z)
45 A(Z + 54) = A(Z)
50 NEXT Z
60 FOR Z = 1 TO 14
70 READ B$(Z)
80 NEXT Z
200 FOR Z = 1 TO 200
210 X = INT(108 * RND) + 1
220 Y = INT(108 * RND) + 1
230 SWAP A(X), A(Y)
240 NEXT Z
250 PRINT "HOW MANY PLAYERS?"
260 PP$ = INKEY$: IF PP$ = "" THEN 260
265 IF PP$ = "Q" OR PP$ = "q" THEN END
270 IF VAL(PP$) > 9 OR VAL(PP$) < 1 THEN SOUND 60, .1: GOTO 260
280 PP = VAL(PP$)
285 LOCATE 1, 18: PRINT PP
288 Z = PP
289 IF PP = 9 THEN Z = 8
290 FOR X = 1 TO Z
293 LOCATE X + 2, 1: PRINT "PLAYER "; X;
294 IF PP <> 9 THEN INPUT Q$(X)
295 IF Q$(X) = "Q" OR Q$(X) = "q" THEN END
296 IF Q$(X) = "" THEN Q$(X) = "COMPUTER": LOCATE X + 2, 13: PRINT "COMPUTER"
300 FOR Y = 1 TO 4
310 D = D + 1: C(X, Y) = A(D)
320 NEXT Y
330 NEXT X
335 IF PP = 9 THEN PP = 8
340 CLS
345 FOR Z = 1 TO PP
346 LOCATE 24, Z * 2: PRINT Z;
347 NEXT Z
350 V = 0: W = 12: GOSUB 2000

400 IF R = 0 AND S <> 1 THEN P = P + 1: IF P > PP THEN P = 1
402 IF R = 1 AND S <> 1 THEN P = P - 1: IF P = 0 THEN P = PP
403 IF S > 0 THEN S = S - 1
405 IF C(P, 1) = 100 THEN 400
406 LOCATE 11, 35: PRINT "("; P; ") "; Q$(P); "'S TURN                ";
408 ERT = 0
410 FOR X = 100 TO 400 STEP 100
420 W = C(P, (X - 100) / 100 + 1): Y = 200: XX = X + 80: YY = 320
425 IF W = 14 THEN 435
426 IF W < 10 AND W + 1 + SC > 98 THEN 435
430 GOSUB 1000: ERT = ERT + 2 ^ ((X - 100) / 100)
435 NEXT X
436 IF ERT = 0 THEN
437 SF = 0
438 FOR Z = 1 TO PP
439 IF C(Z, 1) <> 100 THEN SF = SF + 1
440 NEXT Z
441 IF SF = 1 THEN
442 LOCATE 11, 35: PRINT "("; P; ") "; Q$(P); " IS THE WINNER!"
443 LOCATE 1, 1: PRINT "PLAY AGAIN?"
444 FG$ = INKEY$: IF FG$ = "" THEN 444
445 IF FG$ = "Y" OR F$ = "y" THEN CLEAR : RESTORE: GOTO 15
446 IF FG$ <> "N" AND FG$ <> "n" THEN SOUND 60, .1: GOTO 444
447 END
449 END IF
452 LOCATE 11, 35: PRINT "("; P; ") "; Q$(P); " IS OUT OF THE GAME!"
453 LOCATE 24, P * 2: PRINT "  ";
454 SOUND 1047, .5
455 FOR Z = 1 TO 1000: NEXT Z
456 LOCATE 11, 38: PRINT "                                   "
457 C(P, 1) = 100: GOTO 400
458 END IF
459 W = 12: GOSUB 2000
460 W = C(P, 1): X = C(P, 2): Y = C(P, 3): Z = C(P, 4)
470 IF ERT = 1 THEN I$ = "1": GOTO 601
480 IF ERT = 2 THEN I$ = "2": GOTO 601
490 IF ERT = 4 THEN I$ = "3": GOTO 601
500 IF ERT = 8 THEN I$ = "4": GOTO 601
510 K$ = INKEY$
590 IF Q$(P) = "COMPUTER" THEN GOSUB 3000: GOTO 601
600 I$ = INKEY$: IF I$ = "" THEN 600
601 IF (VAL(I$) < 1 OR VAL(I$) > 4) AND I$ <> "Q" AND I$ <> "q" AND K$ <> "Q" AND K$ <> "q" THEN SOUND 60, .1: GOTO 600
602 IF I$ = "Q" OR I$ = "q" OR K$ = "Q" OR K$ = "q" THEN END
604 IF C(P, VAL(I$)) < 10 AND C(P, VAL(I$)) + 1 + SC > 98 THEN SOUND 60, .1: GOTO 600
606 IF C(P, VAL(I$)) = 14 THEN SOUND 60, .1: GOTO 600
608 IF S = 1 AND C(P, VAL(I$)) > 10 THEN S = 2
612 SCO = SC
613 IF C(P, VAL(I$)) < 10 AND C(P, VAL(I$)) > 0 THEN SC = SC + C(P, VAL(I$)) + 1
614 IF C(P, VAL(I$)) = 10 THEN SC = SC - 10: IF SC < 0 THEN SC = 0
615 IF SC <> SCO THEN V = SCO: W = 0: GOSUB 2000: V = SC: W = 12: GOSUB 2000
618 IF C(P, VAL(I$)) = 12 THEN R = R + 1: IF R = 2 THEN R = 0
619 IF C(P, VAL(I$)) = 13 THEN S = 2
620 W = C(P, VAL(I$)): X = 100: Y = 50: XX = 180: YY = 170: GOSUB 1000
630 SOUND 131, .1
640 D = D + 1: C(P, VAL(I$)) = A(D)
650 W = C(P, VAL(I$)): X = ((VAL(I$) - 1) * 100) + 100: Y = 200: XX = X + 80: YY = 320: GOSUB 1000
950 LINE (100, 200)-(480, 320), 0, BF
980 GOTO 400


1000 IF W < 10 OR W = 14 THEN Z = 15
1010 IF W = 10 THEN Z = 12
1020 IF W = 11 THEN Z = 14
1030 IF W = 12 THEN Z = 5
1040 IF W = 13 THEN Z = 2
1050 LINE (X, Y)-(XX, YY), Z, BF
1060 LINE (X, Y)-(XX, YY), 15, B
1070 LINE (X + 2, Y + 2)-(XX - 2, YY - 2), 0, B
1080 LINE (X + 5, Y + 5)-(XX - 5, YY - 5), 0, B
1090 IF W > 2 AND W < 9 AND W <> 6 THEN LINE (X + 30, Y + 20)-(X + 30, Y + 30), 12
1100 IF W = 1 OR W = 5 OR W = 7 THEN LINE (X + 30, Y + 30)-(X + 30, Y + 40), 12
1110 IF W > 0 AND W < 9 AND W <> 4 AND W <> 5 THEN LINE (X + 50, Y + 20)-(X + 50, Y + 30), 12
1120 IF W > 1 AND W < 9 THEN LINE (X + 50, Y + 30)-(X + 50, Y + 40), 12
1130 IF W > 0 AND W < 9 AND W <> 3 THEN LINE (X + 30, Y + 20)-(X + 50, Y + 20), 12
1140 IF W > 0 AND W < 9 AND W <> 6 THEN LINE (X + 30, Y + 30)-(X + 50, Y + 30), 12
1150 IF W > 0 AND W < 9 AND W <> 3 AND W <> 6 THEN LINE (X + 30, Y + 40)-(X + 50, Y + 40), 12
1160 IF W = 9 THEN
1170 LINE (X + 25, Y + 20)-(X + 25, Y + 40), 12
1180 LINE (X + 35, Y + 20)-(X + 55, Y + 20), 12
1190 LINE -(X + 55, Y + 40), 12
1200 LINE -(X + 35, Y + 40), 12
1210 LINE -(X + 35, Y + 20), 12
1220 END IF
1230 IF W = 10 THEN
1240 LINE (X + 15, Y + 30)-(X + 20, Y + 30), 0
1250 LINE (X + 25, Y + 20)-(X + 25, Y + 40), 0
1260 LINE (X + 35, Y + 20)-(X + 55, Y + 20), 0
1270 LINE -(X + 55, Y + 40), 0
1280 LINE -(X + 35, Y + 40), 0
1290 LINE -(X + 35, Y + 20), 0
1300 END IF
1310 IF W = 11 THEN
1320 LINE (X + 30, Y + 20)-(X + 30, Y + 40), 0
1330 LINE (X + 30, Y + 30)-(X + 50, Y + 30), 0
1340 LINE (X + 50, Y + 20)-(X + 50, Y + 40), 0
1350 END IF
1360 IF W = 12 THEN
1370 LINE (X + 30, Y + 20)-(X + 30, Y + 40), 0
1380 LINE (X + 30, Y + 20)-(X + 40, Y + 20), 0
1390 LINE -(X + 50, Y + 25), 0
1400 LINE -(X + 40, Y + 30), 0
1410 LINE -(X + 30, Y + 30), 0
1420 LINE -(X + 40, Y + 30), 0
1430 LINE -(X + 50, Y + 40), 0
1440 END IF
1450 IF W = 13 THEN
1460 LINE (X + 30, Y + 20)-(X + 30, Y + 40), 0
1470 LINE -(X + 40, Y + 40), 0
1480 LINE -(X + 50, Y + 35), 0
1490 LINE -(X + 50, Y + 25), 0
1500 LINE -(X + 40, Y + 20), 0
1510 LINE -(X + 30, Y + 20), 0
1520 END IF
1530 IF W = 14 THEN
1540 LINE (X + 30, Y + 40)-(X + 35, Y + 30), 0
1550 LINE -(X + 35, Y + 20), 0
1560 LINE -(X + 25, Y + 20), 0
1570 LINE -(X + 25, Y + 30), 0
1580 LINE -(X + 35, Y + 30), 0
1590 LINE (X + 50, Y + 40)-(X + 55, Y + 30), 0
1600 LINE -(X + 55, Y + 20), 0
1610 LINE -(X + 45, Y + 20), 0
1620 LINE -(X + 45, Y + 30), 0
1630 LINE -(X + 55, Y + 30), 0
1640 END IF
1650 LOCATE 22, X / 8 + 4: PRINT (X - 100) / 100 + 1
1660 RETURN

2000 X = 280: Y = 100
2010 Z = INT(V / 10)
2020 IF Z = 0 OR (Z > 3 AND Z < 10 AND Z <> 7) THEN LINE (X + 30, Y + 20)-(X + 30, Y + 30), W
2030 IF Z = 0 OR Z = 2 OR Z = 6 OR Z = 8 THEN LINE (X + 30, Y + 30)-(X + 30, Y + 40), W
2040 IF Z > -1 AND Z < 10 AND Z <> 5 AND Z <> 6 THEN LINE (X + 50, Y + 20)-(X + 50, Y + 30), W
2050 IF Z > -1 AND Z < 10 AND Z <> 2 THEN LINE (X + 50, Y + 30)-(X + 50, Y + 40), W
2060 IF Z > -1 AND Z < 10 AND Z <> 1 AND Z <> 4 THEN LINE (X + 30, Y + 20)-(X + 50, Y + 20), W
2070 IF Z > 1 AND Z < 10 AND Z <> 7 THEN LINE (X + 30, Y + 30)-(X + 50, Y + 30), W
2080 IF Z > -1 AND Z < 10 AND Z <> 1 AND Z <> 4 AND Z <> 7 THEN LINE (X + 30, Y + 40)-(X + 50, Y + 40), W
2090 X = 310: Y = 100
2100 Z = V MOD 10
2110 IF Z = 0 OR (Z > 3 AND Z < 10 AND Z <> 7) THEN LINE (X + 30, Y + 20)-(X + 30, Y + 30), W
2120 IF Z = 0 OR Z = 2 OR Z = 6 OR Z = 8 THEN LINE (X + 30, Y + 30)-(X + 30, Y + 40), W
2130 IF Z > -1 AND Z < 10 AND Z <> 5 AND Z <> 6 THEN LINE (X + 50, Y + 20)-(X + 50, Y + 30), W
2140 IF Z > -1 AND Z < 10 AND Z <> 2 THEN LINE (X + 50, Y + 30)-(X + 50, Y + 40), W
2150 IF Z > -1 AND Z < 10 AND Z <> 1 AND Z <> 4 THEN LINE (X + 30, Y + 20)-(X + 50, Y + 20), W
2160 IF Z > 1 AND Z < 10 AND Z <> 7 THEN LINE (X + 30, Y + 30)-(X + 50, Y + 30), W
2170 IF Z > -1 AND Z < 10 AND Z <> 1 AND Z <> 4 AND Z <> 7 THEN LINE (X + 30, Y + 40)-(X + 50, Y + 40), W
2180 RETURN

3000 V = 9
3010 IF V < 10 AND V + 1 + SC > 98 THEN 3070
3020 IF V > 13 THEN RETURN
3030 IF W = V AND W < 14 AND (ERT MOD 2 > 0 AND ERT MOD 2 < 2) THEN I$ = "1": J$ = I$: RETURN
3040 IF X = V AND X < 14 AND (ERT MOD 4 > 1 AND ERT MOD 4 < 4) THEN I$ = "2": J$ = I$: RETURN
3050 IF Y = V AND Y < 14 AND (ERT MOD 8 > 3 AND ERT MOD 8 < 8) THEN I$ = "3": J$ = I$: RETURN
3060 IF Z = V AND Z < 14 AND (ERT MOD 16 > 7 AND ERT MOD 16 < 16) THEN I$ = "4": J$ = I$: RETURN
3070 IF V < 10 AND V > 1 THEN V = V - 1: GOTO 3010
3080 IF V = 1 THEN V = 11: GOTO 3010
3090 IF V = 11 THEN V = 10: GOTO 3010
3100 IF V = 10 THEN V = 12: GOTO 3010
3110 IF V = 12 THEN V = 13: GOTO 3010
3120 RETURN

10000 DATA 1,1,1,2,2,2,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7,8,8,8,9,9,9,9,9,9,9,9,9,9
10010 DATA 10,10,10,10,11,11,11,11,12,12,12,12,12,12,13,13,14,14,14,14
10020 DATA 2,3,4,5,6,7,8,9,10,-10,HOLD,REVERSE,DOUBLE PLAY,O'NO 99


' Release: MINEFIND by Folker Fritz
' Version: 1.0 (2003-03-22)
'  Status: 100% Freeware
'   EMail: folker.fritz@gmx.de
'Homepage: http://www.quickbasic.6x.to

DECLARE SUB GPRINT (FFTEXT$, FFHEIGHT!, FFWIDTH!)
DECLARE SUB INGET (ANZAHLE!, Stellen!, Zeilen!, X$)
DECLARE SUB CPRINT (FFTEXT$, FFHEIGHT!, FFWIDTH!, FFCOLOR1%, FFCOLOR2%, FFCOLOR3%)
DECLARE SUB FELT (X%, Y%, XX%, YY%, FARBEN%, HFARBE%, DFARBE%)
DECLARE SUB PUTT (PX!, PY!, PNUMMER$)
TYPE POSI
 A AS STRING * 4
 B AS STRING * 25
 C AS STRING * 10
 D AS STRING * 8
END TYPE
DIM AREA(650) AS INTEGER
DIM AREASHOW(650) AS INTEGER
DIM AREAMINE(650) AS INTEGER
DIM SHARED BREITE AS INTEGER
DIM SHARED HOEHE AS INTEGER
DIM SHARED BREIT AS INTEGER
DIM SHARED POSI(48) AS POSI
RANDOMIZE TIMER

BREIT = 20   'width of every small area
MIENEN = 10  'default mines at start
BREITE = 9   'default width of whole area
HOEHE = 9    'default height of whole area

ON ERROR GOTO Fehler
CLS
Fehler:
SCREEN 0
WIDTH 80, 25
COLOR 14, 4
LOCATE 1, 29: PRINT " MINEFIND Version 1.00 "
COLOR 8, 0
LOCATE 1, 52: PRINT "Ü"
LOCATE 2, 30: PRINT "ßßßßßßßßßßßßßßßßßßßßßßß"
LOCATE 3, 80: PRINT "Ü"
LOCATE 4, 3: PRINT "ßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßßß"
COLOR 15, 1
LOCATE 3, 2: PRINT "                                                                              "
LOCATE 3, 53: PRINT "- This program is Freeware "
LOCATE 3, 2: PRINT " (C) 2003 by Folker Fritz"
IF ERR <> 0 THEN GOTO 98
COLOR 31, 0
LOCATE 6, 2: PRINT "TESTING DISC ..."
COLOR 15

CLOSE #1, 1
OPEN "MINEFIND.HIG" FOR RANDOM AS #1
FIELD #1, 4 AS A$, 25 AS B$, 10 AS C$, 8 AS D$
GET #1, 1
IF EOF(1) THEN
FOR POSITION = 1 TO 48
 AA$ = "9999"
 BB$ = "Noname"
 CC$ = MID$(DATE$, 4, 2) + "." + MID$(DATE$, 1, 2) + "." + MID$(DATE$, 7, 4)
 DD$ = TIME$
 LSET A$ = AA$
 LSET B$ = BB$
 LSET C$ = CC$
 LSET D$ = DD$
 PUT #1, POSITION
NEXT
END IF
AA$ = "9999"
LSET A$ = AA$
PUT #1, 48

GOTO 13.3
98
COLOR 15, 0
SELECT CASE ERR
 CASE 61, 68, 70, 71, 72, 75, 76:
  LOCATE 6, 2: PRINT "DISC ERROR .......: NUMBER" + STR$(ERR); " - NO HIGHSCORES SHOWN!"
  NOHIGHSCORES = 1
  IF ERR = 61 THEN KILL "MINEFIND.HIG"
 CASE ELSE:
  LOCATE 6, 2: PRINT "UNKNOWN ERROR ....: NUMBER" + STR$(ERR);
  BEEP
  WHILE INKEY$ = "": WEND
  END
END SELECT
13.3
IF NOHIGHSCORES = 0 THEN LOCATE 6, 2: PRINT "TESTING DISC .....: OK"
LOCATE , 2: PRINT "NOW LOADING ......: OK"
PLAY "L2n0n0n0"

SCREEN 12
WIDTH 80, 60

5

FOR A = 1 TO 650
 AREA(A) = 0
 AREASHOW(A) = 0
 AREAMINE(A) = 0
NEXT

CLS

GPRINT "MINEFIND", 1.2, 2
5.1

HCENTER = (21 - HOEHE) / 2
BCENTER = (30 - BREITE) / 2
REST = BREITE * HOEHE - MIENEN

CPRINT "START GAME", 24, 34, 15, 11, 3
CPRINT "GAME OPTIONS", 30, 34, 15, 11, 3
CPRINT "HIGHSCORES", 36, 34, 15, 11, 3
CPRINT "END GAME", 42, 34, 15, 11, 3
HM = 0

3
FOR X = 0 TO 3
 IF X <> HM THEN FELT 230, 176 + 48 * X, 250, 196 + 48 * X, 7, 15, 8
 FELT 230, 176 + 48 * HM, 250, 196 + 48 * HM, 4, 12, 8
NEXT
A$ = "": WHILE A$ = "": A$ = INKEY$: WEND
SELECT CASE A$
 CASE CHR$(0) + "H": IF HM > 0 THEN HM = HM - 1 ELSE HM = 3
 CASE CHR$(0) + "P": IF HM < 3 THEN HM = HM + 1 ELSE HM = 0
 CASE CHR$(13):
  IF HM = 0 THEN GOTO 4
  IF HM = 1 THEN GOTO 6
  IF HM = 2 AND NOHIGHSCORES = 0 THEN GOTO 8
  IF HM = 3 THEN SCREEN 9: SCREEN 0: END
END SELECT
GOTO 3
	 
6
FELT 0, 100, 639, 479, 0, 0, 0

CPRINT "LEVEL:", 21, 34, 15, 11, 3
CPRINT "WIDTH:", 27, 34, 15, 11, 3
CPRINT "HEIGHT:", 33, 34, 15, 11, 3
CPRINT "MINES:", 39, 34, 15, 11, 3
CPRINT "MAIN MENU", 45, 34, 15, 11, 3

IF LEVEL = 0 THEN CPRINT "EASY  ", 21, 41, 15, 7, 8
IF LEVEL = 1 THEN CPRINT "MEDIUM", 21, 41, 15, 7, 8
IF LEVEL = 2 THEN CPRINT "HARD  ", 21, 41, 15, 7, 8
IF LEVEL = 3 THEN CPRINT "CUSTOM", 21, 41, 15, 7, 8
CPRINT STR$(BREITE) + " ", 27, 40, 15, 7, 8
CPRINT STR$(HOEHE) + " ", 33, 41, 15, 7, 8
CPRINT STR$(MIENEN) + " ", 39, 40, 15, 7, 8
HM = 0

7
FOR X = 0 TO 4
 IF X <> HM THEN FELT 230, 152 + 48 * X, 250, 172 + 48 * X, 7, 15, 8
 FELT 230, 152 + 48 * HM, 250, 172 + 48 * HM, 4, 12, 8
NEXT
A$ = "": WHILE A$ = "": A$ = INKEY$: WEND
SELECT CASE A$
 CASE CHR$(0) + "H": IF HM > 0 THEN HM = HM - 1 ELSE HM = 4
 CASE CHR$(0) + "P": IF HM < 4 THEN HM = HM + 1 ELSE HM = 0
 CASE CHR$(0) + "M":
  IF HM = 0 THEN
   IF LEVEL < 2 THEN LEVEL = LEVEL + 1
   IF LEVEL = 1 THEN CPRINT "MEDIUM", 21, 41, 15, 7, 8
   IF LEVEL = 2 THEN CPRINT "HARD  ", 21, 41, 15, 7, 8
   IF LEVEL = 1 THEN HOEHE = 16
   IF LEVEL = 1 THEN BREITE = 16
   IF LEVEL = 1 THEN MIENEN = 40
   IF LEVEL = 2 THEN HOEHE = 16
   IF LEVEL = 2 THEN BREITE = 30
   IF LEVEL = 2 THEN MIENEN = 99
   CPRINT STR$(BREITE) + " ", 27, 40, 15, 7, 8
   CPRINT STR$(HOEHE) + " ", 33, 41, 15, 7, 8
   CPRINT STR$(MIENEN) + " ", 39, 40, 15, 7, 8
  END IF
  IF HM = 1 THEN
   IF BREITE < 30 THEN BREITE = BREITE + 1
   CPRINT STR$(BREITE) + " ", 27, 40, 15, 7, 8
   LEVEL = 3
   IF HOEHE = 9 AND BREITE = 9 AND MIENEN = 10 THEN LEVEL = 0
   IF HOEHE = 16 AND BREITE = 16 AND MIENEN = 40 THEN LEVEL = 1
   IF HOEHE = 16 AND BREITE = 30 AND MIENEN = 99 THEN LEVEL = 2
   IF LEVEL = 0 THEN CPRINT "EASY  ", 21, 41, 15, 7, 8
   IF LEVEL = 1 THEN CPRINT "MEDIUM", 21, 41, 15, 7, 8
   IF LEVEL = 2 THEN CPRINT "HARD  ", 21, 41, 15, 7, 8
   IF LEVEL = 3 THEN CPRINT "CUSTOM", 21, 41, 15, 7, 8
  END IF
  IF HM = 2 THEN
   IF HOEHE < 21 THEN HOEHE = HOEHE + 1
   CPRINT STR$(HOEHE) + " ", 33, 41, 15, 7, 8
   LEVEL = 3
   IF HOEHE = 9 AND BREITE = 9 AND MIENEN = 10 THEN LEVEL = 0
   IF HOEHE = 16 AND BREITE = 16 AND MIENEN = 40 THEN LEVEL = 1
   IF HOEHE = 16 AND BREITE = 30 AND MIENEN = 99 THEN LEVEL = 2
   IF LEVEL = 0 THEN CPRINT "EASY  ", 21, 41, 15, 7, 8
   IF LEVEL = 1 THEN CPRINT "MEDIUM", 21, 41, 15, 7, 8
   IF LEVEL = 2 THEN CPRINT "HARD  ", 21, 41, 15, 7, 8
   IF LEVEL = 3 THEN CPRINT "CUSTOM", 21, 41, 15, 7, 8
  END IF
  IF HM = 3 THEN
   IF MIENEN < FIX((HOEHE * BREITE) / 4) THEN MIENEN = MIENEN + 1
   CPRINT STR$(MIENEN) + " ", 39, 40, 15, 7, 8
   LEVEL = 3
   IF HOEHE = 9 AND BREITE = 9 AND MIENEN = 10 THEN LEVEL = 0
   IF HOEHE = 16 AND BREITE = 16 AND MIENEN = 40 THEN LEVEL = 1
   IF HOEHE = 16 AND BREITE = 30 AND MIENEN = 99 THEN LEVEL = 2
   IF LEVEL = 0 THEN CPRINT "EASY  ", 21, 41, 15, 7, 8
   IF LEVEL = 1 THEN CPRINT "MEDIUM", 21, 41, 15, 7, 8
   IF LEVEL = 2 THEN CPRINT "HARD  ", 21, 41, 15, 7, 8
   IF LEVEL = 3 THEN CPRINT "CUSTOM", 21, 41, 15, 7, 8
  END IF
 CASE CHR$(0) + "K":
  IF HM = 0 THEN
   IF LEVEL > 0 THEN LEVEL = LEVEL - 1
   IF LEVEL = 0 THEN CPRINT "EASY  ", 21, 41, 15, 7, 8
   IF LEVEL = 1 THEN CPRINT "MEDIUM", 21, 41, 15, 7, 8
   IF LEVEL = 2 THEN CPRINT "HARD  ", 21, 41, 15, 7, 8
   IF LEVEL = 0 THEN HOEHE = 9
   IF LEVEL = 0 THEN BREITE = 9
   IF LEVEL = 0 THEN MIENEN = 10
   IF LEVEL = 1 THEN HOEHE = 16
   IF LEVEL = 1 THEN BREITE = 16
   IF LEVEL = 1 THEN MIENEN = 40
   IF LEVEL = 2 THEN HOEHE = 16
   IF LEVEL = 2 THEN BREITE = 30
   IF LEVEL = 2 THEN MIENEN = 99
   CPRINT STR$(BREITE) + " ", 27, 40, 15, 7, 8
   CPRINT STR$(HOEHE) + " ", 33, 41, 15, 7, 8
   CPRINT STR$(MIENEN) + " ", 39, 40, 15, 7, 8
  END IF
  IF HM = 1 THEN
   IF BREITE > 4 THEN BREITE = BREITE - 1
   CPRINT STR$(BREITE) + " ", 27, 40, 15, 7, 8
   IF MIENEN > FIX((HOEHE * BREITE) / 4) THEN
    MIENEN = FIX((HOEHE * BREITE) / 4)
    CPRINT STR$(MIENEN) + " ", 39, 40, 15, 7, 8
   END IF
   LEVEL = 3
   IF HOEHE = 9 AND BREITE = 9 AND MIENEN = 10 THEN LEVEL = 0
   IF HOEHE = 16 AND BREITE = 16 AND MIENEN = 40 THEN LEVEL = 1
   IF HOEHE = 16 AND BREITE = 30 AND MIENEN = 99 THEN LEVEL = 2
   IF LEVEL = 0 THEN CPRINT "EASY  ", 21, 41, 15, 7, 8
   IF LEVEL = 1 THEN CPRINT "MEDIUM", 21, 41, 15, 7, 8
   IF LEVEL = 2 THEN CPRINT "HARD  ", 21, 41, 15, 7, 8
   IF LEVEL = 3 THEN CPRINT "CUSTOM", 21, 41, 15, 7, 8
  END IF
  IF HM = 2 THEN
   IF HOEHE > 4 THEN HOEHE = HOEHE - 1
   CPRINT STR$(HOEHE) + " ", 33, 41, 15, 7, 8
   IF MIENEN > FIX((HOEHE * BREITE) / 4) THEN
    MIENEN = FIX((HOEHE * BREITE) / 4)
    CPRINT STR$(MIENEN) + " ", 39, 40, 15, 7, 8
   END IF
   LEVEL = 3
   IF HOEHE = 9 AND BREITE = 9 AND MIENEN = 10 THEN LEVEL = 0
   IF HOEHE = 16 AND BREITE = 16 AND MIENEN = 40 THEN LEVEL = 1
   IF HOEHE = 16 AND BREITE = 30 AND MIENEN = 99 THEN LEVEL = 2
   IF LEVEL = 0 THEN CPRINT "EASY  ", 21, 41, 15, 7, 8
   IF LEVEL = 1 THEN CPRINT "MEDIUM", 21, 41, 15, 7, 8
   IF LEVEL = 2 THEN CPRINT "HARD  ", 21, 41, 15, 7, 8
   IF LEVEL = 3 THEN CPRINT "CUSTOM", 21, 41, 15, 7, 8
  END IF
  IF HM = 3 THEN
   IF MIENEN > 1 THEN MIENEN = MIENEN - 1
   CPRINT STR$(MIENEN) + " ", 39, 40, 15, 7, 8
   LEVEL = 3
   IF HOEHE = 9 AND BREITE = 9 AND MIENEN = 10 THEN LEVEL = 0
   IF HOEHE = 16 AND BREITE = 16 AND MIENEN = 40 THEN LEVEL = 1
   IF HOEHE = 16 AND BREITE = 30 AND MIENEN = 99 THEN LEVEL = 2
   IF LEVEL = 0 THEN CPRINT "EASY  ", 21, 41, 15, 7, 8
   IF LEVEL = 1 THEN CPRINT "MEDIUM", 21, 41, 15, 7, 8
   IF LEVEL = 2 THEN CPRINT "HARD  ", 21, 41, 15, 7, 8
   IF LEVEL = 3 THEN CPRINT "CUSTOM", 21, 41, 15, 7, 8
  END IF
 CASE CHR$(13):
  IF HM = 4 THEN FELT 0, 100, 639, 479, 0, 0, 0: GOTO 5.1
 CASE CHR$(27): FELT 0, 100, 639, 479, 0, 0, 0: GOTO 5.1
END SELECT
GOTO 7

4
CLS
TIMESTART = FIX(TIMER)

MIENEN2 = MIENEN

H = HCENTER + HOEHE + 1
FOR B = BCENTER TO BREITE + BCENTER + 1
 FELT B * BREIT, H * BREIT, B * BREIT + BREIT - 1, H * BREIT + BREIT - 1, 8, 7, 0
NEXT

H = HCENTER
FOR B = BCENTER TO BREITE + BCENTER + 1
  FELT B * BREIT, H * BREIT, B * BREIT + BREIT - 1, H * BREIT + BREIT - 1, 8, 7, 0
NEXT

B = BCENTER
FOR H = HCENTER + 1 TO HOEHE + HCENTER + 1
 FELT B * BREIT, H * BREIT, B * BREIT + BREIT - 1, H * BREIT + BREIT - 1, 8, 7, 0
NEXT

B = BCENTER + BREITE + 1
FOR H = HCENTER + 1 TO HOEHE + HCENTER + 1
 FELT B * BREIT, H * BREIT, B * BREIT + BREIT - 1, H * BREIT + BREIT - 1, 8, 7, 0
NEXT

FOR X = 1 TO MIENEN
 A = FIX(RND * HOEHE * BREITE)
 IF A = 0 OR AREA(A) = 9 THEN X = X - 1
 AREA(A) = 9
NEXT

FOR H = 1 + HCENTER TO HOEHE + HCENTER
 FOR B = 1 + BCENTER TO BREITE + BCENTER
  FELT B * BREIT, H * BREIT, B * BREIT + BREIT - 1, H * BREIT + BREIT - 1, 7, 15, 8
 NEXT
NEXT

A = 0
FOR H = 1 TO HOEHE
 FOR B = 1 TO BREITE
  A = A + 1
  IF H <> 1 THEN IF B <> 1 THEN IF AREA(A - BREITE - 1) > 8 THEN AREA(A) = AREA(A) + 1
  IF H <> 1 THEN IF AREA(A - BREITE) > 8 THEN AREA(A) = AREA(A) + 1
  IF H <> 1 THEN IF B <> BREITE THEN IF AREA(A - BREITE + 1) > 8 THEN AREA(A) = AREA(A) + 1
  IF B <> 1 THEN IF AREA(A - 1) > 8 THEN AREA(A) = AREA(A) + 1
  IF B <> BREITE THEN IF AREA(A + 1) > 8 THEN AREA(A) = AREA(A) + 1
  IF H <> HOEHE THEN IF B <> 1 THEN IF AREA(A + BREITE - 1) > 8 THEN AREA(A) = AREA(A) + 1
  IF H <> HOEHE THEN IF AREA(A + BREITE) > 8 THEN AREA(A) = AREA(A) + 1
  IF H <> HOEHE THEN IF B <> BREITE THEN IF AREA(A + BREITE + 1) > 8 THEN AREA(A) = AREA(A) + 1
  IF AREA(A) > 9 THEN AREA(A) = 9
 NEXT
NEXT

B = 1 + BCENTER: H = 1 + HCENTER: A = 1
FELT B * BREIT, H * BREIT, B * BREIT + BREIT - 1, H * BREIT + BREIT - 1, 16, 14, 14

CPRINT "AREAS LEFT:", 60, 10, 14, 10, 2
CPRINT STR$(REST), 60, 21, 15, 7, 8
CPRINT "MINES LEFT:", 60, 28, 14, 10, 2
CPRINT STR$(MIENEN), 60, 39, 15, 7, 8
CPRINT "TIME:", 60, 46, 14, 10, 2
CPRINT "0", 60, 52, 15, 7, 8
CPRINT "LEVEL: ", 60, 59, 14, 10, 2
IF LEVEL = 0 THEN CPRINT "EASY  ", 60, 66, 15, 7, 8
IF LEVEL = 1 THEN CPRINT "MEDIUM", 60, 66, 15, 7, 8
IF LEVEL = 2 THEN CPRINT "HARD  ", 60, 66, 15, 7, 8
IF LEVEL = 3 THEN CPRINT "CUSTOM", 60, 66, 15, 7, 8

1 A$ = "": WHILE A$ = "": A$ = INKEY$:
IF ENDTIME$ <> "9999" THEN
 IF FIX(TIMER) <> TEMPTIME THEN
  TEMPTIME = FIX(TIMER)
  IF FIX(TIMER) > TIMESTART THEN
   ENDTIME = FIX(TIMER) - TIMESTART
   IF ENDTIME > 9999 THEN ENDTIME = 9999
   ENDTIME$ = STR$(ENDTIME)
   CPRINT ENDTIME$ + "  ", 60, 51, 15, 7, 8
  END IF
  IF FIX(TIMER) < TIMESTART THEN
   ENDTIME = 86400 - TIMESTART + FIX(TIMER)
   IF ENDTIME > 9999 THEN ENDTIME = 9999
   ENDTIME$ = STR$(ENDTIME)
   CPRINT ENDTIME$ + "  ", 60, 51, 15, 7, 8
  END IF
 END IF
END IF
WEND
SELECT CASE A$
 CASE CHR$(0) + "M":
  IF B < BREITE + BCENTER THEN
   IF AREASHOW(A) = 0 THEN FELT B * BREIT, H * BREIT, B * BREIT + BREIT - 1, H * BREIT + BREIT - 1, 16, 15, 8
   IF AREASHOW(A) = 1 THEN FELT B * BREIT, H * BREIT, B * BREIT + BREIT - 1, H * BREIT + BREIT - 1, 16, 7, 7
   B = B + 1
   A = A + 1
   FELT B * BREIT, H * BREIT, B * BREIT + BREIT - 1, H * BREIT + BREIT - 1, 16, 14, 14
  END IF
 CASE CHR$(0) + "K":
  IF B > 1 + BCENTER THEN
   IF AREASHOW(A) = 0 THEN FELT B * BREIT, H * BREIT, B * BREIT + BREIT - 1, H * BREIT + BREIT - 1, 16, 15, 8
   IF AREASHOW(A) = 1 THEN FELT B * BREIT, H * BREIT, B * BREIT + BREIT - 1, H * BREIT + BREIT - 1, 16, 7, 7
   B = B - 1
   A = A - 1
   FELT B * BREIT, H * BREIT, B * BREIT + BREIT - 1, H * BREIT + BREIT - 1, 16, 14, 14
  END IF
 CASE CHR$(0) + "P":
  IF H < HOEHE + HCENTER THEN
   IF AREASHOW(A) = 0 THEN FELT B * BREIT, H * BREIT, B * BREIT + BREIT - 1, H * BREIT + BREIT - 1, 16, 15, 8
   IF AREASHOW(A) = 1 THEN FELT B * BREIT, H * BREIT, B * BREIT + BREIT - 1, H * BREIT + BREIT - 1, 16, 7, 7
   H = H + 1
   A = A + BREITE
   FELT B * BREIT, H * BREIT, B * BREIT + BREIT - 1, H * BREIT + BREIT - 1, 16, 14, 14
  END IF
 CASE CHR$(0) + "H":
  IF H > 1 + HCENTER THEN
   IF AREASHOW(A) = 0 THEN FELT B * BREIT, H * BREIT, B * BREIT + BREIT - 1, H * BREIT + BREIT - 1, 16, 15, 8
   IF AREASHOW(A) = 1 THEN FELT B * BREIT, H * BREIT, B * BREIT + BREIT - 1, H * BREIT + BREIT - 1, 16, 7, 7
   H = H - 1
   A = A - BREITE
   FELT B * BREIT, H * BREIT, B * BREIT + BREIT - 1, H * BREIT + BREIT - 1, 16, 14, 14
  END IF
 CASE CHR$(13):
  IF AREAMINE(A) = 1 THEN GOTO 1
  IF AREASHOW(A) = 1 THEN GOTO 1 ELSE AREASHOW(A) = 1
  REST = REST - 1
  A$ = LTRIM$(STR$(AREA(A)))
  IF AREA(A) > 8 THEN A$ = "X"
  IF AREA(A) > 8 THEN FELT B * BREIT, H * BREIT, B * BREIT + BREIT - 1, H * BREIT + BREIT - 1, 4, 12, 8
  PUTT H * BREIT, B * BREIT, A$
  IF AREA(A) = 0 THEN
  AA = 0
  IF HOEHE > BREITE THEN CHECK = HOEHE * 1.5
  IF HOEHE <= BREITE THEN CHECK = BREITE * 1.5
  FOR SD = 1 TO CHECK
  AA = 0
  FOR HH = 1 + HCENTER TO HOEHE + HCENTER
   FOR BB = 1 + BCENTER TO BREITE + BCENTER
    AA = AA + 1
    IF AREA(AA) = 0 AND AREASHOW(AA) = 1 THEN
     NEW = NEW + 1
     IF HH <> 1 + HCENTER THEN
      IF BB <> 1 + BCENTER AND AREASHOW(AA - BREITE - 1) <> 1 THEN
       FELT BB * BREIT - BREIT, HH * BREIT - BREIT, BB * BREIT - BREIT + BREIT - 1, HH * BREIT - BREIT + BREIT - 1, 16, 7, 7
       A$ = LTRIM$(STR$(AREA(AA - BREITE - 1)))
       PUTT HH * BREIT - BREIT, BB * BREIT - BREIT, A$
       AREASHOW(AA - BREITE - 1) = 1
       REST = REST - 1
      END IF
      IF AREASHOW(AA - BREITE) <> 1 THEN
       FELT BB * BREIT, HH * BREIT - BREIT, BB * BREIT + BREIT - 1, HH * BREIT - BREIT + BREIT - 1, 16, 7, 7
       A$ = LTRIM$(STR$(AREA(AA - BREITE)))
       PUTT HH * BREIT - BREIT, BB * BREIT, A$
       AREASHOW(AA - BREITE) = 1
       REST = REST - 1
      END IF
      IF BB <> BREITE + BCENTER AND AREASHOW(AA - BREITE + 1) <> 1 THEN
       FELT BB * BREIT + BREIT, HH * BREIT - BREIT, BB * BREIT + BREIT + BREIT - 1, HH * BREIT - BREIT + BREIT - 1, 16, 7, 7
       A$ = LTRIM$(STR$(AREA(AA - BREITE + 1)))
       PUTT HH * BREIT - BREIT, BB * BREIT + BREIT, A$
       AREASHOW(AA - BREITE + 1) = 1
       REST = REST - 1
      END IF
     END IF
     IF BB <> 1 + BCENTER AND AREASHOW(AA - 1) <> 1 THEN
      FELT BB * BREIT - BREIT, HH * BREIT, BB * BREIT - BREIT + BREIT - 1, HH * BREIT + BREIT - 1, 16, 7, 7
      A$ = LTRIM$(STR$(AREA(AA - 1)))
      PUTT HH * BREIT, BB * BREIT - BREIT, A$
      AREASHOW(AA - 1) = 1
      REST = REST - 1
     END IF
     IF BB <> BREITE + BCENTER AND AREASHOW(AA + 1) <> 1 THEN
      FELT BB * BREIT + BREIT, HH * BREIT, BB * BREIT + BREIT + BREIT - 1, HH * BREIT + BREIT - 1, 16, 7, 7
      A$ = LTRIM$(STR$(AREA(AA + 1)))
      PUTT HH * BREIT, BB * BREIT + BREIT, A$
      AREASHOW(AA + 1) = 1
      REST = REST - 1
     END IF
     IF HH <> HOEHE + HCENTER THEN
      IF BB <> 1 + BCENTER AND AREASHOW(AA + BREITE - 1) <> 1 THEN
       FELT BB * BREIT - BREIT, HH * BREIT + BREIT, BB * BREIT - BREIT + BREIT - 1, HH * BREIT + BREIT + BREIT - 1, 16, 7, 7
       A$ = LTRIM$(STR$(AREA(AA + BREITE - 1)))
       PUTT HH * BREIT + BREIT, BB * BREIT - BREIT, A$
       AREASHOW(AA + BREITE - 1) = 1
       REST = REST - 1
      END IF
      IF AREASHOW(AA + BREITE) <> 1 THEN
       FELT BB * BREIT, HH * BREIT + BREIT, BB * BREIT + BREIT - 1, HH * BREIT + BREIT + BREIT - 1, 16, 7, 7
       A$ = LTRIM$(STR$(AREA(AA + BREITE)))
       PUTT HH * BREIT + BREIT, BB * BREIT, A$
       AREASHOW(AA + BREITE) = 1
       REST = REST - 1
      END IF
      IF BB <> BREITE + BCENTER AND AREASHOW(AA + BREITE + 1) <> 1 THEN
       FELT BB * BREIT + BREIT, HH * BREIT + BREIT, BB * BREIT + BREIT + BREIT - 1, HH * BREIT + BREIT + BREIT - 1, 16, 7, 7
       A$ = LTRIM$(STR$(AREA(AA + BREITE + 1)))
       PUTT HH * BREIT + BREIT, BB * BREIT + BREIT, A$
       AREASHOW(AA + BREITE + 1) = 1
       REST = REST - 1
      END IF
     END IF
    END IF
   NEXT
  NEXT
  NEXT
  END IF
  CPRINT STR$(REST) + "  ", 60, 21, 15, 7, 8
  IF AREA(A) > 8 THEN
   A = 0
   FOR H = 1 + HCENTER TO HOEHE + HCENTER
    FOR B = 1 + BCENTER TO BREITE + BCENTER
     A = A + 1
     IF AREA(A) <> 9 AND AREAMINE(A) = 1 AND AREASHOW(A) <> 1 THEN PUTT H * BREIT, B * BREIT, "W"
    NEXT
   NEXT
   WHILE INKEY$ = "": WEND
   GOTO 5
  END IF
 CASE " ":
  IF AREASHOW(A) <> 1 THEN
   IF AREAMINE(A) = 2 THEN AREAMINE(A) = 0: FELT B * BREIT, H * BREIT, B * BREIT + BREIT - 1, H * BREIT + BREIT - 1, 7, 16, 16: GOTO 2
   IF AREAMINE(A) = 1 THEN AREAMINE(A) = 2: MIENEN2 = MIENEN2 + 1: PUTT H * BREIT, B * BREIT, "Q": GOTO 2
   IF AREAMINE(A) = 0 THEN AREAMINE(A) = 1: MIENEN2 = MIENEN2 - 1: PUTT H * BREIT, B * BREIT, "F": GOTO 2
2  CPRINT STR$(MIENEN2) + "  ", 60, 39, 15, 7, 8
  END IF
 CASE CHR$(27):
  GOTO 5
END SELECT
IF REST = 0 THEN
 A = 0
 FELT B * BREIT, H * BREIT, B * BREIT + BREIT - 1, H * BREIT + BREIT - 1, 16, 7, 7
 FOR H = 1 + HCENTER TO HOEHE + HCENTER
  FOR B = 1 + BCENTER TO BREITE + BCENTER
   A = A + 1
   A$ = LTRIM$(STR$(AREA(A)))
   IF AREA(A) = 9 AND AREAMINE(A) <> 1 THEN PUTT H * BREIT, B * BREIT, "F"
  NEXT
 NEXT
 CPRINT "0  ", 60, 40, 15, 7, 8
 WHILE INKEY$ = "": WEND
 GOTO 9
END IF
GOTO 1

8
IF NOHIGHSCORES = 1 THEN GOTO 5
CLS
LH = 1
MP = 15
RANDOMIZE TIMER
HCOLOR% = FIX(RND * 7 + 1)

FOR POSITION = 1 TO MP
 IF POSITION = 1 THEN CPRINT STR$(POSITION) + ".", 4 + LH + POSITION, 8, 15, 14, 10
 IF POSITION <> 1 THEN CPRINT STR$(POSITION) + ".", 4 + LH + POSITION, 8, 15, 11, 3
NEXT

FOR POSITION = 1 TO MP
 IF POSITION = 1 THEN CPRINT STR$(POSITION) + ".", 23 + LH + POSITION, 8, 15, 14, 10
 IF POSITION <> 1 THEN CPRINT STR$(POSITION) + ".", 23 + LH + POSITION, 8, 15, 11, 3
NEXT

FOR POSITION = 1 TO MP
 IF POSITION = 1 THEN CPRINT STR$(POSITION) + ".", 42 + LH + POSITION, 8, 15, 14, 10
 IF POSITION <> 1 THEN CPRINT STR$(POSITION) + ".", 42 + LH + POSITION, 8, 15, 11, 3
NEXT

HX = 22
FOR HY = 4.5 TO 117
 FELT HX * 4, HY * 4, HX * 4 + 3, HY * 4 + 3, HCOLOR%, HCOLOR% + 8, 8
NEXT

FOR HY = 4.5 TO 40.5
 HX = 37
 FELT HX * 4, HY * 4, HX * 4 + 3, HY * 4 + 3, HCOLOR%, HCOLOR% + 8, 8
 HX = 93
 FELT HX * 4, HY * 4, HX * 4 + 3, HY * 4 + 3, HCOLOR%, HCOLOR% + 8, 8
 HX = 120
 FELT HX * 4, HY * 4, HX * 4 + 3, HY * 4 + 3, HCOLOR%, HCOLOR% + 8, 8
NEXT

FOR HY = 46.5 TO 78.5
 HX = 37
 FELT HX * 4, HY * 4, HX * 4 + 3, HY * 4 + 3, HCOLOR%, HCOLOR% + 8, 8
 HX = 93
 FELT HX * 4, HY * 4, HX * 4 + 3, HY * 4 + 3, HCOLOR%, HCOLOR% + 8, 8
 HX = 120
 FELT HX * 4, HY * 4, HX * 4 + 3, HY * 4 + 3, HCOLOR%, HCOLOR% + 8, 8
NEXT

FOR HY = 84.5 TO 116.5
 HX = 37
 FELT HX * 4, HY * 4, HX * 4 + 3, HY * 4 + 3, HCOLOR%, HCOLOR% + 8, 8
 HX = 93
 FELT HX * 4, HY * 4, HX * 4 + 3, HY * 4 + 3, HCOLOR%, HCOLOR% + 8, 8
 HX = 120
 FELT HX * 4, HY * 4, HX * 4 + 3, HY * 4 + 3, HCOLOR%, HCOLOR% + 8, 8
NEXT

HX = 143
FOR HY = 4.5 TO 117
 FELT HX * 4, HY * 4, HX * 4 + 3, HY * 4 + 3, HCOLOR%, HCOLOR% + 8, 8
NEXT

HY = 4.5
FOR HX = 22 TO 143
 FELT HX * 4, HY * 4, HX * 4 + 3, HY * 4 + 3, HCOLOR%, HCOLOR% + 8, 8
NEXT

HY = 8.5
FOR HX = 22 TO 143
 FELT HX * 4, HY * 4, HX * 4 + 3, HY * 4 + 3, HCOLOR%, HCOLOR% + 8, 8
NEXT

HY = 40.5
FOR HX = 22 TO 143
 FELT HX * 4, HY * 4, HX * 4 + 3, HY * 4 + 3, HCOLOR%, HCOLOR% + 8, 8
NEXT

HY = 46.5
FOR HX = 22 TO 143
 FELT HX * 4, HY * 4, HX * 4 + 3, HY * 4 + 3, HCOLOR%, HCOLOR% + 8, 8
NEXT

HY = 78.5
FOR HX = 22 TO 143
 FELT HX * 4, HY * 4, HX * 4 + 3, HY * 4 + 3, HCOLOR%, HCOLOR% + 8, 8
NEXT

HY = 84.5
FOR HX = 22 TO 143
 FELT HX * 4, HY * 4, HX * 4 + 3, HY * 4 + 3, HCOLOR%, HCOLOR% + 8, 8
NEXT

HY = 116.5
FOR HX = 22 TO 143
 FELT HX * 4, HY * 4, HX * 4 + 3, HY * 4 + 3, HCOLOR%, HCOLOR% + 8, 8
NEXT

CPRINT "HIGHSCORES LEVEL EASY", 1 + LH, 30, 15, 13, 5
CPRINT "HIGHSCORES LEVEL MEDIUM", 22 + LH, 29, 15, 13, 5
CPRINT "HIGHSCORES LEVEL HARD", 41 + LH, 30, 15, 13, 5

CPRINT "TIME", 3 + LH, 14, 15, 7, 8
CPRINT "NAME", 3 + LH, 32, 15, 7, 8
CPRINT "DATE", 3 + LH, 52.5, 15, 7, 8
CPRINT "TIME", 3 + LH, 65, 15, 7, 8

CLOSE #1, 1
OPEN "MINEFIND.HIG" FOR RANDOM AS #1
FIELD #1, 4 AS A$, 25 AS B$, 10 AS C$, 8 AS D$

FOR POSITION = 1 TO 15
 GET #1, POSITION
 IF RTRIM$(A$) <> "9999" THEN
  IF POSITION = 1 THEN CPRINT RTRIM$(A$), 4 + POSITION + LH, 14 + 4 - LEN(RTRIM$(A$)), 15, 14, 10
  IF POSITION = 1 THEN CPRINT B$, 4 + POSITION + LH, 21.5, 15, 14, 10
  IF POSITION = 1 THEN CPRINT C$, 4 + POSITION + LH, 49.5, 15, 14, 10
  IF POSITION = 1 THEN CPRINT D$, 4 + POSITION + LH, 63, 15, 14, 10
  IF POSITION <> 1 THEN CPRINT RTRIM$(A$), 4 + POSITION + LH, 14 + 4 - LEN(RTRIM$(A$)), 15, 11, 3
  IF POSITION <> 1 THEN CPRINT B$, 4 + POSITION + LH, 21.5, 15, 11, 3
  IF POSITION <> 1 THEN CPRINT C$, 4 + POSITION + LH, 49.5, 15, 11, 3
  IF POSITION <> 1 THEN CPRINT D$, 4 + POSITION + LH, 63, 15, 11, 3
 END IF
NEXT

FOR POSITION = 17 TO 31
 GET #1, POSITION
 IF RTRIM$(A$) <> "9999" THEN
  IF POSITION = 17 THEN CPRINT RTRIM$(A$), 7 + POSITION + LH, 14 + 4 - LEN(RTRIM$(A$)), 15, 14, 10
  IF POSITION = 17 THEN CPRINT B$, 7 + POSITION + LH, 21.5, 15, 14, 10
  IF POSITION = 17 THEN CPRINT C$, 7 + POSITION + LH, 49.5, 15, 14, 10
  IF POSITION = 17 THEN CPRINT D$, 7 + POSITION + LH, 63, 15, 14, 10
  IF POSITION <> 17 THEN CPRINT RTRIM$(A$), 7 + POSITION + LH, 14 + 4 - LEN(RTRIM$(A$)), 15, 11, 3
  IF POSITION <> 17 THEN CPRINT B$, 7 + POSITION + LH, 21.5, 15, 11, 3
  IF POSITION <> 17 THEN CPRINT C$, 7 + POSITION + LH, 49.5, 15, 11, 3
  IF POSITION <> 17 THEN CPRINT D$, 7 + POSITION + LH, 63, 15, 11, 3
 END IF
NEXT

FOR POSITION = 33 TO 47
 GET #1, POSITION
 IF RTRIM$(A$) <> "9999" THEN
  IF POSITION = 33 THEN CPRINT RTRIM$(A$), 10 + POSITION + LH, 14 + 4 - LEN(RTRIM$(A$)), 15, 14, 10
  IF POSITION = 33 THEN CPRINT B$, 10 + POSITION + LH, 21.5, 15, 14, 10
  IF POSITION = 33 THEN CPRINT C$, 10 + POSITION + LH, 49.5, 15, 14, 10
  IF POSITION = 33 THEN CPRINT D$, 10 + POSITION + LH, 63, 15, 14, 10
  IF POSITION <> 33 THEN CPRINT RTRIM$(A$), 10 + POSITION + LH, 14 + 4 - LEN(RTRIM$(A$)), 15, 11, 3
  IF POSITION <> 33 THEN CPRINT B$, 10 + POSITION + LH, 21.5, 15, 11, 3
  IF POSITION <> 33 THEN CPRINT C$, 10 + POSITION + LH, 49.5, 15, 11, 3
  IF POSITION <> 33 THEN CPRINT D$, 10 + POSITION + LH, 63, 15, 11, 3
 END IF
NEXT

CLOSE #1
WHILE INKEY$ = "": WEND
GOTO 5

9
IF LEVEL = 3 THEN GOTO 5
IF NOHIGHSCORES = 1 THEN GOTO 5
CLS

CLOSE #1, 1
OPEN "MINEFIND.HIG" FOR RANDOM AS #1
FIELD #1, 4 AS A$, 25 AS B$, 10 AS C$, 8 AS D$

FOR POSITION = 1 TO 48
 GET #1, POSITION
 POSI(POSITION).A = A$
 POSI(POSITION).B = B$
 POSI(POSITION).C = C$
 POSI(POSITION).D = D$
NEXT

CPRINT "YOU HAVE REACHED A NEW HIGHSCORE!!!", 28, 23, 14, 12, 4
CPRINT "PLEASE ENTER YOUR NAME:", 30, 13, 14, 10, 2
INGET 30, 30, 37, X$
IF RTRIM$(X$) = "" THEN X$ = "Noname"

IF LEVEL = 0 THEN IF ENDTIME < VAL(POSI(15).A) THEN GOTO 9.1 ELSE GOTO 5
IF LEVEL = 1 THEN IF ENDTIME < VAL(POSI(31).A) THEN GOTO 9.2 ELSE GOTO 5
IF LEVEL = 2 THEN IF ENDTIME < VAL(POSI(47).A) THEN GOTO 9.3 ELSE GOTO 5

9.1
POSI(15).A = LTRIM$(STR$(ENDTIME))
POSI(15).B = X$
POSI(15).C = MID$(DATE$, 4, 2) + "." + MID$(DATE$, 1, 2) + "." + MID$(DATE$, 7, 4)
POSI(15).D = TIME$
FOR XXX = 1 TO 15
 FOR POSITION = 1 TO 15
  IF VAL(POSI(POSITION + 1).A) < VAL(POSI(POSITION).A) THEN
   TEMPA$ = POSI(POSITION).A
   TEMPB$ = POSI(POSITION).B
   TEMPC$ = POSI(POSITION).C
   TEMPD$ = POSI(POSITION).D
   POSI(POSITION).A = POSI(POSITION + 1).A
   POSI(POSITION).B = POSI(POSITION + 1).B
   POSI(POSITION).C = POSI(POSITION + 1).C
   POSI(POSITION).D = POSI(POSITION + 1).D
   POSI(POSITION + 1).A = TEMPA$
   POSI(POSITION + 1).B = TEMPB$
   POSI(POSITION + 1).C = TEMPC$
   POSI(POSITION + 1).D = TEMPD$
  END IF
 NEXT
NEXT
FOR POSITION = 1 TO 16
 LSET A$ = POSI(POSITION).A
 LSET B$ = POSI(POSITION).B
 LSET C$ = POSI(POSITION).C
 LSET D$ = POSI(POSITION).D
 PUT #1, POSITION
NEXT
GOTO 8

9.2
POSI(31).A = LTRIM$(STR$(ENDTIME))
POSI(31).B = X$
POSI(31).C = MID$(DATE$, 4, 2) + "." + MID$(DATE$, 1, 2) + "." + MID$(DATE$, 7, 4)
POSI(31).D = TIME$
FOR XXX = 1 TO 15
 FOR POSITION = 17 TO 31
  IF VAL(POSI(POSITION + 1).A) < VAL(POSI(POSITION).A) THEN
   TEMPA$ = POSI(POSITION).A
   TEMPB$ = POSI(POSITION).B
   TEMPC$ = POSI(POSITION).C
   TEMPD$ = POSI(POSITION).D
   POSI(POSITION).A = POSI(POSITION + 1).A
   POSI(POSITION).B = POSI(POSITION + 1).B
   POSI(POSITION).C = POSI(POSITION + 1).C
   POSI(POSITION).D = POSI(POSITION + 1).D
   POSI(POSITION + 1).A = TEMPA$
   POSI(POSITION + 1).B = TEMPB$
   POSI(POSITION + 1).C = TEMPC$
   POSI(POSITION + 1).D = TEMPD$
  END IF
 NEXT
NEXT
FOR POSITION = 17 TO 32
 LSET A$ = POSI(POSITION).A
 LSET B$ = POSI(POSITION).B
 LSET C$ = POSI(POSITION).C
 LSET D$ = POSI(POSITION).D
 PUT #1, POSITION
NEXT
GOTO 8

9.3
POSI(47).A = LTRIM$(STR$(ENDTIME))
POSI(47).B = X$
POSI(47).C = MID$(DATE$, 4, 2) + "." + MID$(DATE$, 1, 2) + "." + MID$(DATE$, 7, 4)
POSI(47).D = TIME$
FOR XXX = 1 TO 15
 FOR POSITION = 33 TO 47
  IF VAL(POSI(POSITION + 1).A) < VAL(POSI(POSITION).A) THEN
   TEMPA$ = POSI(POSITION).A
   TEMPB$ = POSI(POSITION).B
   TEMPC$ = POSI(POSITION).C
   TEMPD$ = POSI(POSITION).D
   POSI(POSITION).A = POSI(POSITION + 1).A
   POSI(POSITION).B = POSI(POSITION + 1).B
   POSI(POSITION).C = POSI(POSITION + 1).C
   POSI(POSITION).D = POSI(POSITION + 1).D
   POSI(POSITION + 1).A = TEMPA$
   POSI(POSITION + 1).B = TEMPB$
   POSI(POSITION + 1).C = TEMPC$
   POSI(POSITION + 1).D = TEMPD$
  END IF
 NEXT
NEXT
FOR POSITION = 33 TO 48
 LSET A$ = POSI(POSITION).A
 LSET B$ = POSI(POSITION).B
 LSET C$ = POSI(POSITION).C
 LSET D$ = POSI(POSITION).D
 PUT #1, POSITION
NEXT
GOTO 8

num1:
DATA "       111    "
DATA "    111111    "
DATA "    111111    "
DATA "       111    "
DATA "       111    "
DATA "       111    "
DATA "       111    "
DATA "       111    "
DATA "       111    "
DATA "       111    "
DATA "       111    "
DATA "       111    "

num2:
DATA " 222222222222 "
DATA "22222222222222"
DATA "           222"
DATA "           222"
DATA "           222"
DATA " 2222222222222"
DATA "2222222222222 "
DATA "222           "
DATA "222           "
DATA "222           "
DATA "22222222222222"
DATA "2222222222222 "

num3:
DATA "3333333333333 "
DATA "33333333333333"
DATA "           333"
DATA "           333"
DATA "           333"
DATA "33333333333333"
DATA "33333333333333"
DATA "           333"
DATA "           333"
DATA "           333"
DATA "33333333333333"
DATA "3333333333333 "

num4:
DATA "555        555"
DATA "555        555"
DATA "555        555"
DATA "555        555"
DATA "555        555"
DATA "55555555555555"
DATA " 5555555555555"
DATA "           555"
DATA "           555"
DATA "           555"
DATA "           555"
DATA "           555"

num5:
DATA "6666666666666 "
DATA "66666666666666"
DATA "666           "
DATA "666           "
DATA "666           "
DATA "6666666666666 "
DATA "66666666666666"
DATA "           666"
DATA "           666"
DATA "           666"
DATA "66666666666666"
DATA " 666666666666 "

num6:
DATA " 888888       "
DATA "88888888      "
DATA "888           "
DATA "888           "
DATA "888           "
DATA "8888888888888 "
DATA "88888888888888"
DATA "888        888"
DATA "888        888"
DATA "888        888"
DATA "88888888888888"
DATA " 888888888888 "

num7:
DATA " 444444444444 "
DATA "44444444444444"
DATA "           444"
DATA "           444"
DATA "           444"
DATA "           444"
DATA "           444"
DATA "           444"
DATA "           444"
DATA "           444"
DATA "           444"
DATA "           444"

num8:
DATA " 000000000000 "
DATA "00000000000000"
DATA "000        000"
DATA "000        000"
DATA "000        000"
DATA "00000000000000"
DATA "00000000000000"
DATA "000        000"
DATA "000        000"
DATA "000        000"
DATA "00000000000000"
DATA " 000000000000 "

mine:
DATA " 08  7777  80 "
DATA " 807787877808 "
DATA "  7787878888  "
DATA "  7878888880  "
DATA " 787888888800 "
DATA " 778888888080 "
DATA " 787888888800 "
DATA " 778888888080 "
DATA "  7888888080  "
DATA "  8888080800  "
DATA " 808008080008 "
DATA " 08  0000  80 "

flag:
DATA "      88      "
DATA "    4488      "
DATA "  444488      "
DATA "44444488      "
DATA "      88      "
DATA "      88      "
DATA "      88      "
DATA "      88      "
DATA "    888888    "
DATA "  8800000008  "
DATA " 800000000000 "
DATA " 800000000000 "

question:
DATA " 000000000000 "
DATA "00000000000000"
DATA "000        000"
DATA "           000"
DATA "           000"
DATA "      00000000"
DATA "     00000000 "
DATA "     000      "
DATA "              "
DATA "              "
DATA "     000      "
DATA "     000      "

wrong:
DATA " CC        CC "
DATA " CCC      CCC "
DATA "  CCC    CCC  "
DATA "   CCC  CCC   "
DATA "    CCCCCC    "
DATA "     CCCC     "
DATA "     CCCC     "
DATA "    CCCCCC    "
DATA "   CCC  CCC   "
DATA "  CCC    CCC  "
DATA " CCC      CCC "
DATA " CC        CC "

DEFINT A-Z
SUB CPRINT (FFTEXT$, FFHEIGHT!, FFWIDTH!, FFCOLOR1, FFCOLOR2, FFCOLOR3)
FFWIDTH = FFWIDTH! * 8 - 8
FFHEIGHT = FFHEIGHT! * 8 - 8
DEF SEG = &HFFA6
FOR PIECE = 1 TO LEN(FFTEXT$)
 TEXTPART$ = MID$(FFTEXT$, PIECE, 1)
 ADRESSE = (8 * ASC(TEXTPART$)) + 14
 FOR HL = 0 TO 7
  IF HL = 0 THEN FFCOLOR = FFCOLOR1
  IF HL = 1 THEN FFCOLOR = FFCOLOR1
  IF HL = 2 THEN FFCOLOR = FFCOLOR2
  IF HL = 3 THEN FFCOLOR = FFCOLOR2
  IF HL = 4 THEN FFCOLOR = FFCOLOR2
  IF HL = 5 THEN FFCOLOR = FFCOLOR3
  IF HL = 6 THEN FFCOLOR = FFCOLOR3
  IF HL = 7 THEN FFCOLOR = FFCOLOR3
  MASK = PEEK(ADRESSE + HL) * 128
  LINE (FFWIDTH + KERNX, FFHEIGHT + HL)-(FFWIDTH + 8 + KERNX, FFHEIGHT + HL), 0, BF
  IF MASK >= 16384 THEN MASK = MASK - 16384: PSET (FFWIDTH + KERNX, FFHEIGHT + HL), FFCOLOR
  IF MASK >= 8192 THEN MASK = MASK - 8192: PSET (FFWIDTH + KERNX + 1, FFHEIGHT + HL), FFCOLOR
  IF MASK >= 4096 THEN MASK = MASK - 4096: PSET (FFWIDTH + KERNX + 2, FFHEIGHT + HL), FFCOLOR
  IF MASK >= 2048 THEN MASK = MASK - 2048: PSET (FFWIDTH + KERNX + 3, FFHEIGHT + HL), FFCOLOR
  IF MASK >= 1024 THEN MASK = MASK - 1024: PSET (FFWIDTH + KERNX + 4, FFHEIGHT + HL), FFCOLOR
  IF MASK >= 512 THEN MASK = MASK - 512: PSET (FFWIDTH + KERNX + 5, FFHEIGHT + HL), FFCOLOR
  IF MASK >= 256 THEN MASK = MASK - 256: PSET (FFWIDTH + KERNX + 6, FFHEIGHT + HL), FFCOLOR
  IF MASK >= 128 THEN MASK = MASK - 128: PSET (FFWIDTH + KERNX + 7, FFHEIGHT + HL), FFCOLOR
 NEXT
KERNX = KERNX + 8
NEXT
DEF SEG
END SUB

SUB FELT (X, Y, XX, YY, FARBEN, HFARBE, DFARBE)
IF HFARBE < 16 THEN LINE (X, Y)-(X, YY), HFARBE
IF HFARBE < 16 THEN LINE (X, Y)-(XX, Y), HFARBE
IF DFARBE < 16 THEN LINE (X, YY)-(XX, YY), DFARBE
IF DFARBE < 16 THEN LINE (XX, Y)-(XX, YY), DFARBE
IF FARBEN < 16 THEN LINE (X + 1, Y + 1)-(XX - 1, YY - 1), FARBEN, BF
END SUB

SUB GPRINT (FFTEXT$, FFHEIGHT!, FFWIDTH!)
FFWIDTH = FFWIDTH! * 8 - 8
FFHEIGHT = FFHEIGHT! * 8 - 8
DEF SEG = &HFFA6
FOR PIECE = 1 TO LEN(FFTEXT$)
 TEXTPART$ = MID$(FFTEXT$, PIECE, 1)
 ADRESSE = (8 * ASC(TEXTPART$)) + 14
 FOR HL = 0 TO 7
  IF HL = 0 THEN GCOLOR = 14: GCOLOR2 = 15: GCOLOR3 = 10
  IF HL = 1 THEN GCOLOR = 14: GCOLOR2 = 15: GCOLOR3 = 10
  IF HL = 2 THEN GCOLOR = 10: GCOLOR2 = 14: GCOLOR3 = 2
  IF HL = 3 THEN GCOLOR = 10: GCOLOR2 = 14: GCOLOR3 = 2
  IF HL = 4 THEN GCOLOR = 10: GCOLOR2 = 14: GCOLOR3 = 2
  IF HL = 5 THEN GCOLOR = 2: GCOLOR2 = 10: GCOLOR3 = 6
  IF HL = 6 THEN GCOLOR = 2: GCOLOR2 = 10: GCOLOR3 = 6
  IF HL = 7 THEN GCOLOR = 2: GCOLOR2 = 10: GCOLOR3 = 6
  MASK = PEEK(ADRESSE + HL) * 128
  IF MASK >= 16384 THEN MASK = MASK - 16384: FELT 0 + (FFWIDTH + KERNX) * 8, (FFHEIGHT + HL) * 8, (FFWIDTH + KERNX) * 8 + 7, (FFHEIGHT + HL) * 8 + 7, GCOLOR, GCOLOR2, GCOLOR3
  IF MASK >= 8192 THEN MASK = MASK - 8192: FELT 0 + (FFWIDTH + KERNX + 1) * 8, (FFHEIGHT + HL) * 8, (FFWIDTH + KERNX + 1) * 8 + 7, (FFHEIGHT + HL) * 8 + 7, GCOLOR, GCOLOR2, GCOLOR3
  IF MASK >= 4096 THEN MASK = MASK - 4096: FELT 0 + (FFWIDTH + KERNX + 2) * 8, (FFHEIGHT + HL) * 8, (FFWIDTH + KERNX + 2) * 8 + 7, (FFHEIGHT + HL) * 8 + 7, GCOLOR, GCOLOR2, GCOLOR3
  IF MASK >= 2048 THEN MASK = MASK - 2048: FELT 0 + (FFWIDTH + KERNX + 3) * 8, (FFHEIGHT + HL) * 8, (FFWIDTH + KERNX + 3) * 8 + 7, (FFHEIGHT + HL) * 8 + 7, GCOLOR, GCOLOR2, GCOLOR3
  IF MASK >= 1024 THEN MASK = MASK - 1024: FELT 0 + (FFWIDTH + KERNX + 4) * 8, (FFHEIGHT + HL) * 8, (FFWIDTH + KERNX + 4) * 8 + 7, (FFHEIGHT + HL) * 8 + 7, GCOLOR, GCOLOR2, GCOLOR3
  IF MASK >= 512 THEN MASK = MASK - 512: FELT 0 + (FFWIDTH + KERNX + 5) * 8, (FFHEIGHT + HL) * 8, (FFWIDTH + KERNX + 5) * 8 + 7, (FFHEIGHT + HL) * 8 + 7, GCOLOR, GCOLOR2, GCOLOR3
  IF MASK >= 256 THEN MASK = MASK - 256: FELT 0 + (FFWIDTH + KERNX + 6) * 8, (FFHEIGHT + HL) * 8, (FFWIDTH + KERNX + 6) * 8 + 7, (FFHEIGHT + HL) * 8 + 7, GCOLOR, GCOLOR2, GCOLOR3
  IF MASK >= 128 THEN MASK = MASK - 128: FELT 0 + (FFWIDTH + KERNX + 7) * 8, (FFHEIGHT + HL) * 8, (FFWIDTH + KERNX + 7) * 8 + 7, (FFHEIGHT + HL) * 8 + 7, GCOLOR, GCOLOR2, GCOLOR3
 NEXT
KERNX = KERNX + 8
NEXT
DEF SEG
END SUB

DEFSNG A-Z
SUB INGET (ANZAHLE, Stellen, Zeilen, X$)
X$ = RTRIM$(X$)
B = LEN(X$)
CPRINT X$ + "_", Stellen, Zeilen, 15, 7, 8
1111 A$ = "": WHILE A$ = "": A$ = INKEY$: WEND
IF ASC(A$) < 32 AND ASC(A$) <> 27 AND ASC(A$) <> 13 AND ASC(A$) <> 8 THEN GOTO 1111
IF ASC(A$) > 126 THEN GOTO 1111
IF LEFT$(A$, 1) = CHR$(0) THEN GOTO 1111
SELECT CASE A$
 CASE CHR$(13), CHR$(27): CPRINT X$ + " ", Stellen, Zeilen, 15, 7, 8: EXIT SUB
 CASE CHR$(8): B = B - 1: IF B < 0 THEN B = 0:  ELSE LET X$ = LEFT$(X$, B): CPRINT X$ + "_ ", Stellen, Zeilen, 15, 7, 8
 CASE IS <> "": B = B + 1: IF B = ANZAHLE + 1 THEN B = B - 1: GOTO 1111 ELSE X$ = X$ + A$: CPRINT X$ + "_", Stellen, Zeilen, 15, 7, 8
END SELECT
GOTO 1111
END SUB

SUB PUTT (PX, PY, PNUMMER$)
SWAP PX, PY
PY = PY + 4
PX = PX + 3
SELECT CASE PNUMMER$
   CASE "1": RESTORE num1
   CASE "2": RESTORE num2
   CASE "3": RESTORE num3
   CASE "4": RESTORE num4
   CASE "5": RESTORE num5
   CASE "6": RESTORE num6
   CASE "7": RESTORE num7
   CASE "8": RESTORE num8
   CASE "X": RESTORE mine
   CASE "F": RESTORE flag
   CASE "Q": RESTORE question
   CASE "W": RESTORE wrong
   CASE "0": LINE (PX, PY)-(PX + 13, PY + 12), 7, BF: GOTO 815
   CASE ELSE: GOTO 815
END SELECT
FOR PHOEHE = 1 TO 12
READ bild$
IF PHOEHE = 1 AND PNUMMER$ <> "X" AND PNUMMER$ <> "W" THEN LINE (PX, PY)-(PX + 13, PY + 12), 7, BF
FOR PBREITE = 1 TO LEN(bild$)
   SELECT CASE MID$(bild$, PBREITE, 1)
   CASE "0": PSET (PX + PBREITE - 1, PY + PHOEHE - 1), 0
   CASE "1": PSET (PX + PBREITE - 1, PY + PHOEHE - 1), 1
   CASE "2": PSET (PX + PBREITE - 1, PY + PHOEHE - 1), 2
   CASE "3": PSET (PX + PBREITE - 1, PY + PHOEHE - 1), 3
   CASE "4": PSET (PX + PBREITE - 1, PY + PHOEHE - 1), 4
   CASE "5": PSET (PX + PBREITE - 1, PY + PHOEHE - 1), 5
   CASE "6": PSET (PX + PBREITE - 1, PY + PHOEHE - 1), 6
   CASE "7": PSET (PX + PBREITE - 1, PY + PHOEHE - 1), 7
   CASE "8": PSET (PX + PBREITE - 1, PY + PHOEHE - 1), 8
   CASE "9": PSET (PX + PBREITE - 1, PY + PHOEHE - 1), 9
   CASE "A": PSET (PX + PBREITE - 1, PY + PHOEHE - 1), 10
   CASE "B": PSET (PX + PBREITE - 1, PY + PHOEHE - 1), 11
   CASE "C": PSET (PX + PBREITE - 1, PY + PHOEHE - 1), 12
   CASE "D": PSET (PX + PBREITE - 1, PY + PHOEHE - 1), 13
   CASE "E": PSET (PX + PBREITE - 1, PY + PHOEHE - 1), 14
   CASE "F": PSET (PX + PBREITE - 1, PY + PHOEHE - 1), 15
   CASE ELSE:
   END SELECT
NEXT
NEXT
815
END SUB


RANDOMIZE TIMER
1 OPEN "KENSETUP.DAT" FOR INPUT AS #1
2 INPUT #1, graph$: INPUT #1, graph$
3 INPUT #1, graph$: INPUT #1, graph$: graph$ = LCASE$(graph$)
4 CLOSE #1
6 IF graph$ = "vga" THEN SCREEN 12
7 IF graph$ = "ega" THEN SCREEN 9
8 IF graph$ = "cga" THEN SCREEN 1
9 WINDOW SCREEN (0, 0)-(639, 479)
DEF SEG = 0
mseg& = 256& * PEEK(207) + PEEK(206): mouse% = 256& * PEEK(205) + PEEK(204) + 2&
DEF SEG = mseg&
m1% = 0: m2% = 0: m3% = 0: m4% = 0: CALL absolute(m1%, m2%, m3%, m4%, mouse%)
mousx% = 320: mousy% = 240
10 CLS
15 HOLE = 1
16 PI = 3.141593
20 DIM Q$(128), A$(36), AA(36, 50, 6), AAA(36), PX(50), PY(50), PZ(50), SC(4), SCO(18, 4), PLAY$(4), LIN(11)
21 LIN(1) = 380: LIN(2) = 350: LIN(3) = 322: LIN(4) = 296: LIN(5) = 272
22 LIN(6) = 250: LIN(7) = 230: LIN(8) = 212: LIN(9) = 196: LIN(10) = 182
23 LIN(11) = 170
31 Q$(33) = "020123023024124": Q$(34) = "010111030131"
32 Q$(35) = "010114030134001141003143"
33 Q$(36) = "040110101112132143134104030134010114"
34 Q$(37) = "000110111101100044143133134144040104"
35 Q$(38) = "044111120131113124142": Q$(39) = "020121112"
36 Q$(40) = "020111113124": Q$(41) = "020131133124"
37 Q$(42) = "011133031113021123012132": Q$(43) = "021123012132"
38 Q$(44) = "022123114": Q$(45) = "012132": Q$(46) = "034134": Q$(47) = "004140"
39 Q$(48) = "010130141143134114103101110": Q$(49) = "011120124104024144"
40 Q$(50) = "001110130141104144": Q$(51) = "001110130141132122032143134114103"
41 Q$(52) = "042102130134": Q$(53) = "040100102132143134104"
42 Q$(54) = "041130110101103114134143132102": Q$(55) = "000140141114"
43 Q$(56) = "010130141132112103114134143132012101110"
44 Q$(57) = "044140110101112142": Q$(58) = "021121023123"
45 Q$(59) = "021121023114": Q$(60) = "031112133": Q$(61) = "011131013133"
46 Q$(62) = "011132113": Q$(63) = "024124023122132141130120"
47 Q$(64) = "034114103101110130141143123121132123"
48 Q$(65) = "004101110130141144002142"
49 Q$(66) = "000104134143132102032141130100"
50 Q$(67) = "040110101103114144": Q$(68) = "000104134143141130100"
51 Q$(69) = "040100104144002132": Q$(70) = "040100104002132"
52 Q$(71) = "040110101103114134143142122": Q$(72) = "000104002142040144"
53 Q$(73) = "010130020124014134": Q$(74) = "010130020123114103"
54 Q$(75) = "000104002140002144": Q$(76) = "000104144"
55 Q$(77) = "004100122140144": Q$(78) = "004100144140"
56 Q$(79) = "000140144104100": Q$(80) = "004100130141132102"
57 Q$(81) = "010130141143134114103101110033144"
58 Q$(82) = "004100130141132102032143144"
59 Q$(83) = "040110101112132143134104": Q$(84) = "000140020124"
60 Q$(85) = "000103114134143140": Q$(86) = "000124140"
61 Q$(87) = "000104122144140": Q$(88) = "000144040104"
62 Q$(89) = "000122140022124": Q$(90) = "000140104144"
63 Q$(91) = "030110114134": Q$(92) = "000144": Q$(93) = "010130134114"
64 Q$(94) = "011120131": Q$(95) = "004144": Q$(96) = "020121132"
65 Q$(97) = "033113114134132112": Q$(98) = "010114134143132112"
66 Q$(99) = "032122113124134": Q$(100) = "030134114103112132"
67 Q$(101) = "013133122113124134": Q$(102) = "031120111112102022112114"
68 Q$(103) = "034124113122132134135115": Q$(104) = "010114013122133134"
69 Q$(105) = "021121022124": Q$(106) = "021121022124115104"
70 Q$(107) = "010114013132013134": Q$(108) = "020124"
71 Q$(109) = "014112132134022124": Q$(110) = "014112132134"
72 Q$(111) = "034132112114134": Q$(112) = "015112122133124114"
73 Q$(113) = "034124113122132135144": Q$(114) = "014112132"
74 Q$(115) = "014134133113112132": Q$(116) = "021124134012132"
75 Q$(117) = "012114134132": Q$(118) = "012124132"
76 Q$(119) = "012114122134132": Q$(120) = "012134032114"
77 Q$(121) = "012124032124115": Q$(122) = "012132114134"
78 Q$(123) = "030120121112123124134": Q$(124) = "020121023124"
79 Q$(125) = "010120121132123124114"
80 XX = 20: YY = 200
90 LINE (0, 200)-(640, 200), 11
100 PAINT (5, 205), 10, 11
110 XX = INT(650 * RND) - 5: YY = YY + 8
120 X = (YY - 200) / 50: Y = X
130 GOSUB 10000
140 V = V + 1: IF V < 10 THEN 110
150 FOR R = 10 TO 30 STEP 6
160 TT$ = "MINIGOLF": RR = 280 + R: S = 639 - R: SS = 430: T = R MOD 15: GOSUB 8000
170 NEXT R
180 FOR R = 10 TO 20 STEP 5
190 TT$ = "PROGRAMMED BY KENNETH SILVERMAN": RR = 430 + R: S = 639 - R: SS = 470: T = R MOD 15: GOSUB 8000
200 NEXT R
202 FOR R = 10 TO 12
204 TT$ = "HOW MANY PLAYERS?": RR = R: S = 200 - R: SS = 25: T = R MOD 15: GOSUB 8000
206 NEXT R
208 z$ = INKEY$: IF z$ = "" THEN 208
210 IF VAL(z$) < 1 OR VAL(z$) > 4 THEN SOUND 60, 1: GOTO 208
212 LINE (0, 0)-(188, 30), 0, BF
214 FOR R = 10 TO 12
216 IF z$ = "1" THEN TT$ = "1 PLAYER": RR = R: S = 200 - R: SS = 25: T = R MOD 15: GOSUB 8000
217 IF z$ <> "1" THEN TT$ = z$ + " PLAYERS": RR = R: S = 200 - R: SS = 25: T = R MOD 15: GOSUB 8000
218 NEXT R
219 PLA = VAL(z$)
220 SOUND 1047, 1
222 FOR z = 1 TO PLA
223 LINE (0, 28)-(160, 70), 0, BF
224 FOR R = 10 TO 12
226 TT$ = "PLAYER" + STR$(z) + ":": RR = R + 20: S = 160 - R: SS = 40: T = R MOD 15: GOSUB 8000
228 NEXT R
230 LOCATE 4, 1: INPUT PLAY$(z)
232 IF PLAY$(z) = "" THEN SOUND 60, 1: GOTO 230
234 SOUND 1047, 1
236 NEXT z
238 GOTO 250

240 SCO(HOLE, PL) = SHOT: SC(PL) = SC(PL) + SCO(HOLE, PL)
241 LOCATE 5, 1: PRINT "HOLE IN"; SHOT;
242 LOCATE 4, 1: PRINT "SCORE"; SC(PL)
243 FOR z = 1 TO PLA
244 IF graph$ = "vga" THEN LOCATE 30, (z - 1) * 20 + 1
245 IF graph$ <> "vga" THEN LOCATE 25, (z - 1) * 20 + 1
246 PRINT PLAY$(z); ":"; SC(z);
247 NEXT z
248 z$ = INKEY$: IF z$ = "" THEN 248
249 GOSUB mouse
250 CLS
260 GOSUB 7000
270 PL = PL + 1: IF PL > PLA THEN HOLE = HOLE + 1: PL = 1
280 LOCATE 2, 1: PRINT "HOLE"; HOLE
281 LOCATE 3, 1: PRINT PLAY$(PL); "'S TURN"
282 LOCATE 4, 1: PRINT "SCORE"; SC(PL)
283 FOR z = 1 TO PLA
284 IF graph$ = "vga" THEN LOCATE 30, (z - 1) * 20 + 1
285 IF graph$ <> "vga" THEN LOCATE 25, (z - 1) * 20 + 1
286 PRINT PLAY$(z); ":"; SC(z);
287 NEXT z
292 IF HOLE = 19 THEN END
295 SHOT = 0
300 C = 0: D = 0
310 FOR z = 1 TO LEN(A$(HOLE)) / 6 + 1
320 IF MID$(A$(HOLE), (z - 1) * 6 + 1, 1) = "0" THEN B = 0
330 IF MID$(A$(HOLE), (z - 1) * 6 + 1, 1) = "1" THEN B = 1
340 IF MID$(A$(HOLE), (z - 1) * 6 + 1, 1) = "B" THEN B = 2
350 IF MID$(A$(HOLE), (z - 1) * 6 + 1, 1) = "H" THEN B = 3
360 E = VAL(MID$(A$(HOLE), (z - 1) * 6 + 3, 3)): CC = C: DD = D
370 IF MID$(A$(HOLE), (z - 1) * 6 + 2, 1) = "E" THEN D = D - E
380 IF MID$(A$(HOLE), (z - 1) * 6 + 2, 1) = "X" THEN D = D + E
390 IF MID$(A$(HOLE), (z - 1) * 6 + 2, 1) = "S" THEN C = C - E
400 IF MID$(A$(HOLE), (z - 1) * 6 + 2, 1) = "D" THEN C = C + E
410 IF MID$(A$(HOLE), (z - 1) * 6 + 2, 1) = "W" THEN C = C - E: D = D - E
420 IF MID$(A$(HOLE), (z - 1) * 6 + 2, 1) = "R" THEN C = C + E: D = D - E
430 IF MID$(A$(HOLE), (z - 1) * 6 + 2, 1) = "Z" THEN C = C - E: D = D + E
440 IF MID$(A$(HOLE), (z - 1) * 6 + 2, 1) = "C" THEN C = C + E: D = D + E
450 IF MID$(A$(HOLE), (z - 1) * 6 + 2, 1) = "X" AND B = 2 THEN BX = E
460 IF MID$(A$(HOLE), (z - 1) * 6 + 2, 1) = "Y" AND B = 2 THEN BY = E
470 IF MID$(A$(HOLE), (z - 1) * 6 + 2, 1) = "X" AND B = 3 THEN HX = E
480 IF MID$(A$(HOLE), (z - 1) * 6 + 2, 1) = "Y" AND B = 3 THEN HY = E
490 IF B = 1 THEN LINE (CC, DD)-(C, D), 7
500 NEXT z

510 LOCATE 4, 1: PRINT "SCORE"; SC(PL) + SHOT
511 FOR z = 1 TO PLA
512 IF graph$ = "vga" THEN LOCATE 30, (z - 1) * 20 + 1
513 IF graph$ <> "vga" THEN LOCATE 25, (z - 1) * 20 + 1
514 PRINT PLAY$(z); ":"; SC(z);
516 NEXT z
517 SHOT = SHOT + 1
518 LOCATE 5, 1: PRINT "SHOT"; SHOT
520 FOR z = 1 TO AAA(HOLE)
522 IF AA(HOLE, z, 1) = -1 THEN SWAP AA(HOLE, z, 4), AA(HOLE, z, 6)
525 IF DFG <> 0 THEN LINE (AA(HOLE, z, 3), AA(HOLE, z, 4))-(AA(HOLE, z, 5), AA(HOLE, z, 6)), 7
530 NEXT z
535 IF DFG = 0 THEN PAINT (HX, HY), 10, 7
536 LINE ((HX - 2), (HY - 5))-((HX + 2), (HY + 5)), 8, BF
537 LINE ((HX - 3), (HY - 4))-((HX + 3), (HY + 4)), 8, BF
538 LINE ((HX - 4), (HY - 3))-((HX + 4), (HY + 3)), 8, BF
539 LINE ((HX - 5), (HY - 2))-((HX + 5), (HY + 2)), 8, BF
550 LINE ((BX - 1), (BY - 3))-((BX + 1), (BY + 3)), 15, BF
551 LINE ((BX - 2), (BY - 2))-((BX + 2), (BY + 2)), 15, BF
552 LINE ((BX - 3), (BY - 1))-((BX + 3), (BY + 1)), 15, BF
560 C = BX: D = BY
570 LINE ((C - 3), D)-((C + 3), D), 12
580 LINE (C, (D - 3))-(C, (D + 3)), 12
590 FOR z = 1 TO 11
600 LINE (15, LIN(z))-(30, LIN(z)), 15
610 NEXT z
615 LINE (0, 150)-(12, 440), 0, BF
620 LINE (15, 152)-(30, 430), 15, B
630 LINE (16, 381)-(29, 429), 9, BF

1000 F$ = INKEY$: GOSUB mouse
1010 IF F$ = "" AND m3% = 0 AND m4% = 0 THEN 1000
1020 CC = C: DD = D
1030 IF m3% <> 0 THEN C = C + m3%
1050 IF m4% <> 0 THEN D = D + m4%
1070 IF POINT((C + 3), D) = 0 OR POINT((C - 3), D) = 0 OR POINT(C, (D - 3)) = 0 OR POINT(C, (D + 5)) = 0 THEN C = CC: D = DD: GOTO 1000
1080 IF POINT((C + 3), D) = 7 OR POINT((C - 3), D) = 7 OR POINT(C, (D - 3)) = 7 OR POINT(C, (D + 5)) = 7 THEN C = CC: D = DD: GOTO 1000
1090 LINE ((CC - 3), DD)-((CC + 3), DD), 10
1100 LINE (CC, (DD - 3))-(CC, (DD + 3)), 10
1110 LINE ((C - 3), D)-((C + 3), D), 12
1120 LINE (C, (D - 3))-(C, (D + 3)), 12
1130 IF SQR(((C - HX) * (C - HX)) + ((D - HY) * (D - HY))) < 12 THEN
1132 LINE ((HX - 2), (HY - 5))-((HX + 2), (HY + 5)), 8, BF
1134 LINE ((HX - 3), (HY - 4))-((HX + 3), (HY + 4)), 8, BF
1136 LINE ((HX - 4), (HY - 3))-((HX + 4), (HY + 3)), 8, BF
1138 LINE ((HX - 5), (HY - 2))-((HX + 5), (HY + 2)), 8, BF
1139 END IF
1140 IF SQR(((C - BX) * (C - BX)) + ((D - BY) * (D - BY))) < 10 THEN
1141 LINE ((BX - 1), (BY - 3))-((BX + 1), (BY + 3)), 15, BF
1142 LINE ((BX - 2), (BY - 2))-((BX + 2), (BY + 2)), 15, BF
1143 LINE ((BX - 3), (BY - 1))-((BX + 3), (BY + 1)), 15, BF
1444 END IF
1150 IF F$ = "" THEN F$ = "*"
1160 IF (F$ = " " OR ASC(F$) = 13) AND (C <> BX OR D <> BY) THEN 1200
1165 IF INT(SQR((C - BX) * (C - BX) + (D - BY) * (D - BY)) / 25) <> LAS THEN LOCATE 6, 1: PRINT "FEET -"; INT(SQR((C - BX) * (C - BX) + (D - BY) * (D - BY)) / 25); "  "; : LAS = INT(SQR((C - BX) * (C - BX) + (D - BY) * (D - BY)) / 25)
1170 GOTO 1000

1200 SPEED = -100: CURVE = -100
1205 z = 380
1210 z = z - 1
1220 YY = 0
1230 FOR Y = 1 TO 11
1240 IF LIN(Y) = z THEN YY = 1
1250 NEXT Y
1260 IF YY = 1 THEN LINE (16, z)-(29, z), 15
1270 IF YY = 0 AND z > 170 THEN LINE (16, z)-(29, z), 10
1271 IF YY = 0 AND z < 171 THEN LINE (16, z)-(29, z), 12
1275 'FOR ZZ = 1 TO 2000: NEXT ZZ 'Removed 12/26/2006
     zx = zx + 1: IF zx >= 6 THEN zx = 0: WAIT &H3DA, &H8, &H8: WAIT &H3DA, &H8 'Added 12/26/2006
1280 F$ = INKEY$
1290 IF F$ = "" AND z > 153 THEN 1210
1292 LINE (5, z)-(10, z), 15
1295 z = z - 1
1300 SPEED = ((z * z) - (1542 * z) + 441560) / 2436
1310 z = z + 1
1320 YY = 0
1330 FOR Y = 1 TO 11
1340 IF LIN(Y) = z THEN YY = 1
1350 NEXT Y
1360 IF YY = 1 THEN LINE (16, z)-(29, z), 15
1370 IF YY = 0 THEN LINE (16, z)-(29, z), 0
1375 'FOR ZZ = 1 TO 2000: NEXT ZZ 'Removed 12/26/2006
     zx = zx + 1: IF zx >= 6 THEN zx = 0: WAIT &H3DA, &H8, &H8: WAIT &H3DA, &H8 'Added 12/26/2006
1380 F$ = INKEY$
1381 IF F$ <> "" AND CURVE = -100 THEN
1382 LINE (5, z)-(10, z), 15
1383 CURVE = (z - 380) / 3
1384 END IF
1385 IF z < 429 THEN 1310
1390 Y = SQR((C - BX) * (C - BX) + (D - BY) * (D - BY))
1391 IF C = BX AND D < BY THEN z = PI * 3 / 2: GOTO 1394
1392 IF C = BX AND D > BY THEN z = PI / 2: GOTO 1394
1393 z = ATN((D - BY) / (C - BX))
1394 IF C < BX THEN z = z + PI
1400 z = z + (CURVE / Y)
1404 C = Y * COS(z) + BX
1405 D = Y * SIN(z) + BY
1411 LINE ((CC - 3), DD)-((CC + 3), DD), 10
1412 LINE (CC, (DD - 3))-(CC, (DD + 3)), 10
1415 DFG = 0
1416 ZD = SPEED / 95
1420 GOSUB 2000
1421 LINE ((BX - 1), (BY - 3))-((BX + 1), (BY + 3)), 10, BF
1422 LINE ((BX - 2), (BY - 2))-((BX + 2), (BY + 2)), 10, BF
1423 LINE ((BX - 3), (BY - 1))-((BX + 3), (BY + 1)), 10, BF
1430 DFG = 1

1500 CC = BX: DD = BY
1510 BX = BX + I
1520 BY = BY + J
     'FOR zx = 0 TO 1000: NEXT zx 'Removed 12/26/2006
     zx = zx + 1: IF zx >= 12 THEN zx = 0: WAIT &H3DA, &H8, &H8: WAIT &H3DA, &H8 'Added 12/26/2006
1530 IF SQR((BX - PX(1)) * (BX - PX(1)) + (BY - PY(1)) * (BY - PY(1))) < 9 THEN GOSUB 2000
1540 DFH = SQR((BX - HX) * (BX - HX) + (BY - HY) * (BY - HY))
1541 IF DFH < 10 THEN
1542 LINE ((HX - 2), (HY - 5))-((HX + 2), (HY + 5)), 8, BF
1544 LINE ((HX - 3), (HY - 4))-((HX + 3), (HY + 4)), 8, BF
1545 LINE ((HX - 4), (HY - 3))-((HX + 4), (HY + 3)), 8, BF
1546 LINE ((HX - 5), (HY - 2))-((HX + 5), (HY + 2)), 8, BF
1548 END IF
1550 IF DFH < 8 AND ZD < .8 AND (DFH / 2) + (ZD * 6) < 5 THEN
1551 CIRCLE (INT(CC), INT(DD)), 3, 10
1552 LINE ((HX - 2), (HY - 5))-((HX + 2), (HY + 5)), 8, BF
1553 LINE ((HX - 3), (HY - 4))-((HX + 3), (HY + 4)), 8, BF
1554 LINE ((HX - 4), (HY - 3))-((HX + 4), (HY + 3)), 8, BF
1555 LINE ((HX - 5), (HY - 2))-((HX + 5), (HY + 2)), 8, BF
1556 SOUND 1047, 1: SOUND 784, 1: SOUND 1047, 1: SOUND 784, 1: SOUND 1047, 1: DFG = 0
1557 GOTO 240
1558 END IF
1560 IF INT(CC) = INT(BX) AND INT(DD) = INT(BY) THEN 1685
1670 CIRCLE (INT(CC), INT(DD)), 3, 10
1680 CIRCLE (INT(BX), INT(BY)), 3, 0
1685 ZD = ZD * .9995
1686 IF ZD < .5 THEN ZD = ZD * (1 - ((.5 - ZD) / 300))
1688 I = II * ZD: J = JJ * ZD
1690 IF ZD < .01 THEN
1700 BX = INT(BX): BY = INT(BY)
1710 LINE ((HX - 2), (HY - 5))-((HX + 2), (HY + 5)), 8, BF
1720 LINE ((HX - 3), (HY - 4))-((HX + 3), (HY + 4)), 8, BF
1730 LINE ((HX - 4), (HY - 3))-((HX + 4), (HY + 3)), 8, BF
1740 LINE ((HX - 5), (HY - 2))-((HX + 5), (HY + 2)), 8, BF
1750 GOTO 510
1760 END IF
1990 GOTO 1500

2000 IF DFG = 1 THEN
2002 C = BX: D = BY
2003 IF PZ(1) = 1 THEN BX = BX - JJ: BY = BY - II
2004 IF PZ(1) = -1 THEN BX = BX - JJ * -1: BY = BY - II * -1
2005 IF PZ(1) = 0 THEN BX = BX - II: BY = BY - JJ * -1
2006 IF PZ(1) = 999 THEN BX = BX - II * -1: BY = BY - JJ
2007 END IF
2010 IF BX = C THEN SLOP = 999: INTE = 0: GOTO 2020
2015 SLOP = (BY - D) / (BX - C)
2018 INTE = BY - SLOP * BX
2020 FOR z = 2 TO AAA(HOLE) - 5
2030 PX(z) = 0: PY(z) = 0: PZ(z) = -5
2040 IF AA(HOLE, z, 1) = 999 THEN PX(z) = AA(HOLE, z, 3): GOTO 2080
2050 IF SLOP = 999 THEN PX(z) = BX: PY(z) = AA(HOLE, z, 1) * PX(z) + AA(HOLE, z, 2): GOTO 2090
2060 IF SLOP = AA(HOLE, z, 1) THEN PX(z) = 0: PY(z) = 0: GOTO 2100
2070 PX(z) = (AA(HOLE, z, 2) - INTE) / (SLOP - AA(HOLE, z, 1))
2080 PY(z) = PX(z) * SLOP + INTE
2090 PZ(z) = AA(HOLE, z, 1)
2100 NEXT z
2110 FOR z = 2 TO AAA(HOLE) - 5
2120 IF AA(HOLE, z, 3) > AA(HOLE, z, 5) THEN SWAP AA(HOLE, z, 3), AA(HOLE, z, 5)
2130 IF AA(HOLE, z, 4) > AA(HOLE, z, 6) THEN SWAP AA(HOLE, z, 4), AA(HOLE, z, 6)
2140 IF PX(z) < AA(HOLE, z, 3) - 3 OR PX(z) > AA(HOLE, z, 5) + 3 OR PY(z) < AA(HOLE, z, 4) - 3 OR PY(z) > AA(HOLE, z, 6) + 3 THEN PX(z) = 0: PY(z) = 0: PZ(z) = 0
2150 NEXT z
2160 FOR z = 2 TO AAA(HOLE) - 5
2170 FOR ZZ = 2 TO AAA(HOLE) - 6
2180 IF PX(ZZ + 1) > PX(ZZ) THEN SWAP PX(ZZ + 1), PX(ZZ): SWAP PY(ZZ + 1), PY(ZZ): SWAP PZ(ZZ + 1), PZ(ZZ)
2185 IF SLOP = 999 AND PY(ZZ + 1) > PY(ZZ) THEN SWAP PX(ZZ + 1), PX(ZZ): SWAP PY(ZZ + 1), PY(ZZ): SWAP PZ(ZZ + 1), PZ(ZZ)
2190 NEXT ZZ
2200 NEXT z
2210 IF SLOP <> 999 THEN
2215 z = 2
2220 IF BX < PX(z) THEN z = z + 1: GOTO 2220
2230 IF BX < C THEN PX(1) = PX(z - 1): PY(1) = PY(z - 1): PZ(1) = PZ(z - 1)
2240 IF BX > C THEN PX(1) = PX(z): PY(1) = PY(z): PZ(1) = PZ(z)
2250 END IF
2260 IF SLOP = 999 THEN
2270 z = 2
2280 IF BY < PY(z) THEN z = z + 1: GOTO 2280
2290 IF BY < D THEN PX(1) = PX(z - 1): PY(1) = PY(z - 1): PZ(1) = PZ(z - 1)
2300 IF BY > D THEN PX(1) = PX(z): PY(1) = PY(z): PZ(1) = PZ(z)
2310 END IF
2330 H = SQR((C - BX) * (C - BX) + (D - BY) * (D - BY))
2340 II = (C - BX) / H: JJ = (D - BY) / H
2350 SOUND 220, .5
2360 RETURN

7000 A$(1) = "0C100 1D200 1R100 1D100 1C100 1X100 1Z100 1S100 1W100 1S200 1E100 BX150 BY150 HX400 HY250"
7010 A$(2) = "0C100 1D200 1C100 1X100 1Z100 1S100 1W100 1E200 1X100 1D200 1X100 1S100 0S100 0R050 1R025 BX150 BY150 HX250 HY250"
7020 A$(3) = "0C050 0D200 1Z200 1C200 1R200 1W200 0X150 0D050 1X050 BX200 BY200 HX400 HY250"
7030 A$(4) = "0C050 0D050 1D300 1X400 1S300 1E100 1D200 1E150 1W050 1S150 1E100 0X325 0D225 1C050 BX150 BY100 HX150 HY400"
7040 A$(5) = "0C100 1D200 1C200 1X100 1S100 1E100 1W050 1Z050 1E100 1S200 1E100 BX150 BY150 HX450 HY300"
7050 A$(6) = "0C100 1D300 1X050 1E050 1D150 1X100 1Z100 1S150 1W100 1S100 1E100 0D100 0C025 1C125 BX150 BY150 HX500 HY150"
7060 A$(7) = "0C100 1D200 1C100 1Z050 1X100 1Z050 1S200 1E150 1D200 1R050 1W050 1Z050 1S150 1E100 BX150 BY150 HX150 HY350"
7070 A$(8) = "0C100 1D100 1C050 1X050 1E050 1R050 1D100 1C050 1X150 1S250 1R100 1Z100 1S100 1E100 1D100 1E050 1X050 1S100 1E100 BX150 BY250 HX300 HY250"
7080 A$(9) = "0C050 0X050 1D500 1X250 1S150 1E100 1R050 1S400 1E100 BX100 BY150 HX500 HY300"
7090 A$(10) = "0C050 0D050 1D250 1C100 1X300 1S075 1E250 1R050 1X200 1S050 1X050 1Z050 1S025 1W050 1R050 1C050 1E250 1S250 1E100 BX150 BY100 HX400 HY400"
7100 A$(11) = "0C100 1D400 1X050 1Z050 1X100 1S150 1R100 1Z100 1S050 1W100 1S050 1E100 0C150 1D050 1E100 1S050 1X100 BX150 BY150 HX400 HY250"
7110 A$(12) = "0C050 0D050 1D100 1X100 1C050 1X100 1R200 1D050 1X150 1C050 1Z050 1X050 1Z050 1S200 1W150 1E250 0C300 1X050 1S100 1E050 1D100 BX150 BY100 HX450 HY250"
7120 A$(13) = "0C150 1R100 1C200 1R100 1Z100 1W100 1R150 1C100 1X100 1Z150 1S100 1W200 BX250 BY150 HX450 HY150"
7130 A$(14) = "0C100 1D250 1C150 1X050 1Z050 1S150 1E050 1R050 1D100 1W100 1S050 1Z050 1S150 1E100 BX150 BY150 HX350 HY300"
7140 A$(15) = "0C100 1R050 1D050 1C100 1X100 1S100 1E100 0E100 1D150 1X200 1Z100 1S050 1W100 1E150 BX250 BY200 HX300 HY100"
7150 A$(16) = "0C100 0D100 1D100 1C100 1Z200 1S100 1E100 1D050 1R100 1Z100 1S050 1E100 1R100 BX150 BY250 HX150 HY350"
7160 A$(17) = "0C100 1D100 1X150 1C050 1R050 1D050 0W100 0S050 1D150 1C050 1X050 1Z100 1S100 1W100 1E150 BX150 BY150 HX250 HY200"
7170 A$(18) = "0C100 0X100 1R100 1D050 1C100 1X050 1C050 1R050 1W050 1E050 1D100 1X100 1Z100 1S050 1W050 1E050 1W050 1S050 1Z100 1E100 BX150 BY200 HX450 HY200"
7180 FOR z = 1 TO 18
7185 C = 0: D = 0
7190 FOR ZZ = 1 TO LEN(A$(z)) / 6 + 1
7200 IF MID$(A$(z), (ZZ - 1) * 6 + 1, 1) = "1" THEN B = 1 ELSE B = 0
7360 E = VAL(MID$(A$(z), (ZZ - 1) * 6 + 3, 3)): CC = C: DD = D
7370 IF MID$(A$(z), (ZZ - 1) * 6 + 2, 1) = "E" THEN D = D - E
7380 IF MID$(A$(z), (ZZ - 1) * 6 + 2, 1) = "X" THEN D = D + E
7390 IF MID$(A$(z), (ZZ - 1) * 6 + 2, 1) = "S" THEN C = C - E
7400 IF MID$(A$(z), (ZZ - 1) * 6 + 2, 1) = "D" THEN C = C + E
7410 IF MID$(A$(z), (ZZ - 1) * 6 + 2, 1) = "W" THEN C = C - E: D = D - E
7420 IF MID$(A$(z), (ZZ - 1) * 6 + 2, 1) = "R" THEN C = C + E: D = D - E
7430 IF MID$(A$(z), (ZZ - 1) * 6 + 2, 1) = "Z" THEN C = C - E: D = D + E
7440 IF MID$(A$(z), (ZZ - 1) * 6 + 2, 1) = "C" THEN C = C + E: D = D + E
7445 IF B = 0 THEN 7550
7450 IF D = DD THEN AA(z, ZZ, 1) = 0: GOTO 7490
7460 IF C = CC THEN AA(z, ZZ, 1) = 999: GOTO 7490
7470 IF C - CC = D - DD THEN AA(z, ZZ, 1) = 1
7480 IF C - CC = (D - DD) * -1 THEN AA(z, ZZ, 1) = -1
7490 IF C = CC THEN AA(z, ZZ, 2) = 999: GOTO 7510
7495 IF D = DD THEN AA(z, ZZ, 2) = D: GOTO 7510
7500 AA(z, ZZ, 2) = D - ((C * (D - DD)) / (C - CC))
7510 AA(z, ZZ, 3) = CC
7520 AA(z, ZZ, 4) = DD
7530 AA(z, ZZ, 5) = C
7540 AA(z, ZZ, 6) = D
7550 NEXT ZZ
7560 AAA(z) = ZZ
7980 NEXT z
7990 RETURN

8000 S = (S - R) / 5: SS = (SS - RR) / 4
8010 S = S / LEN(TT$)
8020 FOR V = 1 TO LEN(TT$)
8030 IF ASC(MID$(TT$, V, 1)) > 31 AND ASC(MID$(TT$, V, 1)) < 126 THEN
8040 FOR VV = 1 TO LEN(Q$(ASC(MID$(TT$, V, 1)))) / 3
8050 U = ASC(MID$(Q$(ASC(MID$(TT$, V, 1))), (VV - 1) * 3 + 1, 1)) - 48
8060 UU = ASC(MID$(Q$(ASC(MID$(TT$, V, 1))), (VV - 1) * 3 + 2, 1)) - 48
8070 UUU = ASC(MID$(Q$(ASC(MID$(TT$, V, 1))), (VV - 1) * 3 + 3, 1)) - 48
8075 QQ = UU * S + R + (V - 1) * S * 5: QQQ = UUU * SS + RR
8080 IF U = 1 THEN LINE -(QQ, QQQ), T
8090 IF U = 0 THEN LINE (QQ, QQQ)-(QQ, QQQ), T
8100 NEXT VV
8110 END IF
8120 NEXT V
8130 RETURN

10000 z = 14: GOSUB 11000
10010 PAINT ((0 * X + XX), (-85 * Y + YY)), 2, 14
10020 PAINT ((0 * X + XX), (-55 * Y + YY)), 6, 14
10030 z = 15: GOSUB 11000
10040 RETURN
11000 LINE ((0 * X + XX), (0 * Y + YY))-((10 * X + XX), (0 * Y + YY)), z
11010 LINE -((8 * X + XX), (-50 * Y + YY)), z
11020 LINE -((8 * X + XX), (-60 * Y + YY)), z
11030 LINE -((-8 * X + XX), (-60 * Y + YY)), z
11040 LINE -((8 * X + XX), (-60 * Y + YY)), z
11050 LINE -((60 * X + XX), (-60 * Y + YY)), z
11060 LINE -((40 * X + XX), (-100 * Y + YY)), z
11070 LINE -((45 * X + XX), (-105 * Y + YY)), z
11080 LINE -((20 * X + XX), (-140 * Y + YY)), z
11090 LINE -((25 * X + XX), (-145 * Y + YY)), z
11100 LINE -((0 * X + XX), (-180 * Y + YY)), z
11110 LINE -((-25 * X + XX), (-145 * Y + YY)), z
11120 LINE -((-20 * X + XX), (-140 * Y + YY)), z
11130 LINE -((-45 * X + XX), (-105 * Y + YY)), z
11140 LINE -((-40 * X + XX), (-100 * Y + YY)), z
11150 LINE -((-60 * X + XX), (-60 * Y + YY)), z
11160 LINE -((-8 * X + XX), (-60 * Y + YY)), z
11170 LINE -((-8 * X + XX), (-50 * Y + YY)), z
11180 LINE -((-10 * X + XX), (0 * Y + YY)), z
11190 LINE -((0 * X + XX), (0 * Y + YY)), z
11200 RETURN

DIM regs%(7)
mouse:
   'm1% = 5: m2% = 0: m3% = 0: m4% = 0: CALL absolute(m1%, m2%, m3%, m4%, mouse%)
   regs%(0) = 5: CALL int86old(&H33, regs%(), regs%())
   m1% = regs%(0): m2% = regs%(1): m3% = regs%(2): m4% = regs%(3)
   IF m1% = 1 AND m2% = 1 THEN REM
   IF m1% = 2 THEN REM
   'm1% = 11: m2% = 0: m3% = 0: m4% = 0: CALL absolute(m1%, m2%, m3%, m4%, mouse%)
   regs%(0) = 11: CALL int86old(&H33, regs%(), regs%())
   m1% = regs%(0): m2% = regs%(1): m3% = regs%(2): m4% = regs%(3)
  
   LOCATE
RETURN

